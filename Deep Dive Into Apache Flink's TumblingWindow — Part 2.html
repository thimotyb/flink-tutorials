<!DOCTYPE html>
<!-- saved from url=(0077)https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2 -->
<html lang="en" style="--mobile-announcement-separator-width: 1px; --app-height: 783px;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="In this post, I am going to provide examples of overriding these TumblingWindow defaults and handling late values.">
  <meta name="keywords" content="Apache Flink, element, clock">

  <meta property="og:description" content="In this post, I am going to provide examples of overriding these TumblingWindow defaults and handling late values.">
  <meta property="og:site_name" content="dzone.com">
  <meta property="og:title" content="Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2">
  <meta property="og:url" content="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2">
  <meta property="og:image" content="https://dz2cdn1.dzone.com/storage/article-thumb/13170650-thumb.jpg">
  <meta property="og:type" content="article">

  <meta name="twitter:site" content="@DZoneInc">
  <meta name="twitter:image" content="https://dz2cdn1.dzone.com/storage/article-thumb/13170650-thumb.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:description" content="In this post, I am going to provide examples of overriding these TumblingWindow defaults and handling late values.">
  <meta name="twitter:title" content="Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2">


  <meta name="referrer" content="origin-when-cross-origin">
  <meta name="google-site-verification" content="kndbhxcupfEqWmZclhCpB6vlgOs7QSmx2UHAGGnP2mA">
  <meta name="df-verify" content="df0d76632b4543">

  <link rel="icon" type="image/x-icon" href="https://dz2cdn1.dzone.com/themes/dz20/images/favicon.png">
  <link rel="image_src" href="https://dz2cdn1.dzone.com/storage/article-thumb/13170650-thumb.jpg">
  <link rel="canonical" href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2">

  <title>Deep Dive Into Apache Flink's TumblingWindow — Part 2</title>

  <link rel="preload" href="https://dz2cdn1.dzone.com/themes/dz20/font/fontello.woff?11773374" as="font" type="font/woff" crossorigin="anonymous">

  <link rel="stylesheet" media="all" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/icons.css">
  <link rel="stylesheet" media="all" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/bootstrap.min.css">
  <link rel="stylesheet" media="all" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/global.css">
  <link rel="stylesheet" media="all" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/styles.css">
<style>
    :root {
	    --xs-size: 2px;
        --sm-size: 5px;
        --md-size: 10px;
        --lg-size: 15px;
        --xl-size: 25px;
        --sm-border-size: 8px;
        --sm-font-size: 13px;
        --sm-plus-font-size: 16px;
        --md-font-size: 18px;
        --lg-font-size: 22px;
        --xl-font-size: 26px;
    }

    /* Display Quick-Access Classes */
    .display-none { display: none; }
    .display-block { display: block; }
    .display-inline { display: inline; }
    .display-inline-block { display: inline-block; }

    /* Margin Quick-Access Classes */
    .m-xs { margin: var(--xs-size); }
    .m-sm { margin: var(--sm-size); }
    .m-md { margin: var(--md-size); }
    .m-lg { margin: var(--lg-size); }
    .m-xl { margin: var(--xl-size); }

    .mt-xs, .my-xs { margin-top: var(--xs-size); }
    .mr-xs, .mx-xs { margin-right: var(--xs-size); }
    .mb-xs, .my-xs { margin-bottom: var(--xs-size); }
    .ml-xs, .mx-xs { margin-left: var(--xs-size); }

    .mt-sm, .my-sm { margin-top: var(--sm-size); }
    .mr-sm, .mx-sm { margin-right: var(--sm-size); }
    .mb-sm, .my-sm { margin-bottom: var(--sm-size); }
    .ml-sm, .mx-sm { margin-left: var(--sm-size); }

    .mt-md, .my-md { margin-top: var(--md-size); }
    .mr-md, .mx-md { margin-right: var(--md-size); }
    .mb-md, .my-md { margin-bottom: var(--md-size); }
    .ml-md, .mx-md { margin-left: var(--md-size); }

    .mt-lg, .my-lg { margin-top: var(--lg-size); }
    .mr-lg, .mx-lg { margin-right: var(--lg-size); }
    .mb-lg, .my-lg { margin-bottom: var(--lg-size); }
    .ml-lg, .mx-lg { margin-left: var(--lg-size); }

    .mt-xl, .my-xl { margin-top: var(--xl-size); }
    .mr-xl, .mx-xl { margin-right: var(--xl-size); }
    .mb-xl, .my-xl { margin-bottom: var(--xl-size); }
    .ml-xl, .mx-xl { margin-left: var(--xl-size); }

    .ml-auto, .mx-auto { margin-left: auto; }
    .mr-auto, .mx-auto { margin-right: auto; }
    .mt-auto, .my-auto { margin-top: auto; }
    .mb-auto, .my-auto { margin-bottom: auto; }

    .my-none, .mt-none { margin-top: 0 !important; }
    .mx-none, .mr-none { margin-right: 0 !important; }
    .my-none, .mb-none { margin-bottom: 0 !important; }
    .mx-none, .ml-none { margin-left: 0 !important; }

    /* Padding Quick-Access Classes */
    .p-xs { padding: var(--xs-size); }
    .p-sm { padding: var(--sm-size); }
    .p-md { padding: var(--md-size); }
    .p-lg { padding: var(--lg-size); }
    .p-xl { padding: var(--xl-size); }

    .pt-xs, .py-xs { padding-top: var(--xs-size); }
    .pr-xs, .px-xs { padding-right: var(--xs-size); }
    .pb-xs, .py-xs { padding-bottom: var(--xs-size); }
    .pl-xs, .px-xs { padding-left: var(--xs-size); }

    .pt-sm, .py-sm { padding-top: var(--sm-size); }
    .pr-sm, .px-sm { padding-right: var(--sm-size); }
    .pb-sm, .py-sm { padding-bottom: var(--sm-size); }
    .pl-sm, .px-sm { padding-left: var(--sm-size); }

    .pt-md, .py-md { padding-top: var(--md-size); }
    .pr-md, .px-md { padding-right: var(--md-size); }
    .pb-md, .py-md { padding-bottom: var(--md-size); }
    .pl-md, .px-md { padding-left: var(--md-size); }

    .pt-lg, .py-lg { padding-top: var(--lg-size); }
    .pr-lg, .px-lg { padding-right: var(--lg-size); }
    .pb-lg, .py-lg { padding-bottom: var(--lg-size); }
    .pl-lg, .px-lg { padding-left: var(--lg-size); }

    .pt-xl, .py-xl { padding-top: var(--xl-size); }
    .pr-xl, .px-xl { padding-right: var(--xl-size); }
    .pb-xl, .py-xl { padding-bottom: var(--xl-size); }
    .pl-xl, .px-xl { padding-left: var(--xl-size); }

    .py-none, .pt-none { padding-top: 0 !important; }
    .px-none, .pr-none { padding-right: 0 !important; }
    .py-none, .pb-none { padding-bottom: 0 !important; }
    .px-none, .pl-none { padding-left: 0 !important; }

    /* Flex Quick-Access Classes */
    .flex {
	    display: flex;
    }

    .flex-column {
        display: flex;
        flex-direction: column;
    }

    .flex-column-reverse {
	    display: flex;
	    flex-direction: column-reverse;
    }

    .flex-row {
        display: flex;
        flex-direction: row;
    }

    .flex-row-reverse {
	    display: flex;
	    flex-direction: row-reverse;
    }

    .flex-wrap {
        flex-wrap: wrap;
    }

    .flex-grow {
        flex-grow: 1;
    }

    .align-center { align-items: center; }
    .align-end { align-items: flex-end; }

    .content-center {
	    align-content: center;
    }

    .justify-center { justify-content: center; }
    .justify-start { justify-content: flex-start; }
    .justify-end { justify-content: flex-end; }
    .justify-around { justify-content: space-around; }
    .justify-between { justify-content: space-between; }
    .justify-evenly { justify-content: space-evenly; }

    .gap-sm { gap: var(--sm-size); }
    .gap-md { gap: var(--md-size); }
    .gap-lg { gap: var(--lg-size); }
    .gap-xl { gap: var(--xl-size); }

    /* Display Quick-Access Classes */
    .inline-block { display: inline-block; }

    /* Font Quick-Access Classes */
    .font-xl { font-size: var(--xl-font-size); }
    .font-lg { font-size: var(--lg-font-size); }
    .font-md { font-size: var(--md-font-size); }
    .font-sm-plus { font-size: var(--sm-plus-font-size); }
    .font-sm { font-size: var(--sm-font-size); }

    .font-strike { text-decoration: line-through; }
    .font-underline { text-decoration: underline; }
    .font-overline { text-decoration: overline; }

    .font-italic { font-style: italic; }
    .font-bold { font-weight: bold; }

    .font-black { color: #000000; }
    .font-white { color: #ffffff; }
    .font-gray { color: var(--brand-gray-text); }
    .font-danger { color: var(--header-dropdown-button-bg-danger); }
    .font-center { text-align: center; }

    .no-wrap { white-space: nowrap; }

    /* Consistent headings between h and non-h tags */
    .heading {
	    margin-top: 0;
	    margin-bottom: var(--md-size);
    }

    .heading.font-xl { line-height: var(--xl-font-size); }
    .heading.font-lg { line-height: var(--lg-font-size); }
    .heading.font-md { line-height: var(--md-font-size); }
    .heading.font-sm-plus { line-height: var(--sm-plus-font-size); }
    .heading.font-sm { line-height: var(--sm-font-size); }

    /* Font Clamp Quick-Access Classes */
    .line-clamp,
    .line-clamp-2,
    .line-clamp-3,
    .line-clamp-4,
    .line-clamp-5 {
        display: -webkit-box;
        -webkit-line-clamp: 4;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .line-clamp-2 { -webkit-line-clamp: 2 !important; }
    .line-clamp-3 { -webkit-line-clamp: 3 !important; }
    .line-clamp-4 { -webkit-line-clamp: 4 !important; }
    .line-clamp-5 { -webkit-line-clamp: 5 !important; }

    /* User-Select Quick-Access Classes */
    .select-none { user-select: none; }

    /* Position Quick-Access Classes */
    .absolute { position: absolute; }
    .relative { position: relative; }
    .float-left { float: left; }
    .float-right { float: right; }

    .pos-top { top: 0; }
    .pos-right { right: 0; }
    .pos-bottom { bottom: 0; }
    .pos-left { left: 0; }

    .va-top { vertical-align: top; }
    .va-middle { vertical-align: middle; }
    .va-bottom { vertical-align: bottom; }

    /* Transition Quick-Access Classes */
    .trans-linear-quick {
        transition: all 0.15s linear;
    }

    /* Background Quick-Access Classes */
    .bg-gray { background: #cccccc; }
    .bg-white { background-color: white; }
    .bg-none { background: none; }

    /* Border Quick-Access Classes */
    .border-gray { border: 1px solid #cccccc; }
    .tab-pane.border-gray { border: 1px solid #ddd; }
    .no-border, .border-none { border: none !important; }

    .bt-none { border-top: none !important; }
    .br-none { border-right: none !important; }
    .bb-none { border-bottom: none !important; }
    .bl-none { border-left: none !important; }

    /* Border Radius Quick-Access Classes */

    .round-t-sm, .round-tl-sm { border-top-left-radius: var(--sm-border-size); }
    .round-t-sm, .round-tr-sm { border-top-right-radius: var(--sm-border-size); }
    .round-b-sm, .round-bl-sm { border-bottom-left-radius: var(--sm-border-size); }
    .round-b-sm, .round-br-sm { border-bottom-right-radius: var(--sm-border-size); }
    .round-sm { border-radius: var(--sm-border-size); }
    .round-fully { border-radius: 50%; }

    /* Misc Quick-Access Classes */
    .haikei {
        position: relative;
        background-image: url('https://dz2cdn1.dzone.com/themes/dz20/images/polygon-scatter-haikei-shapes.svg');
        background-repeat: no-repeat;
        background-size: cover;
    }

    .haikei:before {
        content: '';
        position:absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--color-event-background);
        z-index: -1;
    }

    .margin-auto-center {
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    .flex-auto-center {
        display: flex;
        margin-left: auto;
        margin-right: auto;
    }

    .mw-1100 { max-width: 1100px; }
    .mw-1300 { max-width: 1300px; }
    .full-width { width: 100%; }

    .h-separator {
        background-color: #cccccc;
        height: 1px;
        width: 100%;
        margin: 5px auto;
    }

    .no-spacing {
        margin: 0 !important;
        padding: 0 !important;
    }

    .inherit-color { color: inherit; }

    .inherit-decoration { text-decoration: inherit; }

    /* Table Quick-Access Classes */
    .table-border-gray tr:not(:last-child) {
        border-bottom: 1px solid #cccccc;
    }

    table.full-width tr td:last-child {
        width:100%;
    }

    /* Animation Quick-Access Classes */
    @keyframes anim-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(359deg); }
    }

    .anim-spin {
        display: inline-block;
        animation: anim-spin 2s infinite linear;
    }

    .hov-pointer { cursor: pointer; }
    .hov-brighten:hover { filter: brightness(1.2); }
    .hov-darken:hover { filter: brightness(0.95); }
    .hov-underline:hover { text-decoration: underline; }

    /* Small tweaks related to components when using these styles */
    .nav-tabs {
        border-bottom: none;
    }
    .tab-content > .flex-column.active,
    .tab-content > .flex-row.active {
        display: flex;
    }

    /* Alpine components with x-cloak should not be visible by default until conditionals kick in */
    [x-cloak] { display: none !important; }
</style>
  <link rel="stylesheet" media="all" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/modal.css">
  <img src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/pixel.gif" width="1" height="1" alt="" role="presentation" style="margin-left: -9999px; position: absolute !important; bottom: 0px !important; left: 0px !important;"><script type="text/javascript" async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/analytics.js.download"></script><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/up_loader.1.1.0.js.download" async=""></script><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/data.js.download" async=""></script><script type="text/javascript" async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/formcomplete.js.download"></script><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/clarity.js.download"></script><script type="text/javascript" async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/6si.min.js.download"></script><script type="text/javascript" async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/js"></script><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/tag.aspx"></script><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/events.js.download"></script><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/l7xu65at89"></script><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/dyr9vdlv8t"></script><script type="text/javascript" async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/js(1)"></script><script type="text/javascript" async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/js(2)"></script><script type="text/javascript" async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/linkid.js.download"></script><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/gtm.js.download"></script><script defer="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/cdn.min.js.download"></script>
<script>
	document.addEventListener('alpine:init', () => {
		Alpine.store('article', {
			id: null,
			engagement: {
				open: false,
				page: 1,
				users: [],
				additional: true,
				loading: false,
				initializing: false,
				unauthorized: false,
				enqueued: null,
				dequeued: null,

				reset() {
					this.open = false;
					this.page = 1;
					this.users.splice(0);
					this.additional = true;
					this.loading = false;
					this.initializing = false;
					this.enqueued = null;
					this.dequeued = null;
				},

				enqueue(user) {
					this.dequeued = null;
					this.enqueued = user;
				},

				dequeue(user) {
					this.enqueued = null;
					this.dequeued = user;
				},

				add(user) {
					this.users.push(user);
					this.enqueued = null;
				},

				remove(user) {
					const index = this.users.findIndex(u => u.id === user.id);

					if (index !== -1) {
						this.users.splice(index, 1);
					}

					this.dequeued = null;
				},

				contains(user) {
					return this.users.filter(u => u.id === user.id).length;
				}
			}
		});

		Alpine.effect(() => {
			const store = Alpine.store('article');
			if (!store.engagement.additional && store.engagement.enqueued) {
				if (!store.engagement.contains(store.engagement.enqueued)) {
					store.engagement.add(store.engagement.enqueued);
				}
			}
		});

		Alpine.effect(() => {
			const store = Alpine.store('article');
			if (store.engagement.page && store.engagement.dequeued) {
				store.engagement.remove(store.engagement.dequeued);
			}
		})
	});
</script><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A9wSqI5i0iwGdf6L1CERNdmsTPgVu44ewj8QxTBYgsv1LCPUVF7YmWOvTappqB1139jAymxUW/RO8zmMqo4zlAAAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MzY4MTI4MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A+d7vJfYtay4OUbdtRPZA3y7bKQLsxaMEPmxgfhBGqKXNrdkCQeJlUwqa6EBbSfjwFtJWTrWIioXeMW+y8bWAgQAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MzY4MTI4MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/f(12).txt" async=""></script><link href="https://securepubads.g.doubleclick.net/pagead/managed/dict/m202502270101/gpt" rel="compression-dictionary"><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/5055"></script><link id="sa-css" rel="stylesheet" type="text/css" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/sa.css" media="all"><style id="_6si-shortening">/* This stylesheet is created by 6sense */
            .mktoForm .mktoFormRow:has(._6si_sff_filled) {
                display: none;
            }
            .mktoForm .mktoFormRow ._6si_sff_filled {
                display: none;
            }
            .hs-form .hs-form-field:has(._6si_sff_filled) {
                display: none;
            }
            .hs-form .hs-form-field ._6si_sff_filled {
                display: none;
            }
            form .form-field:not(.error):has(._6si_sff_filled) {
                display: none;
            }
            form .form-field:not(.error) ._6si_sff_filled {
                display: none;
            }
            .elq-form .row:has(._6si_sff_filled) {
                display: none;
            }
            .elq-form .row ._6si_sff_filled {
                display: none;
            }
            .elq-form .field-wrapper:has(._6si_sff_filled) {
                display: none;
            }
            .elq-form .field-wrapper ._6si_sff_filled {
                display: none;
            }</style><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/AGSKWxUvVWIbv6sH238cRakHOlKmVhGlXng81evxf9hxW9q7AuEJl8CCNQmiMRL4Dh0PGY0E9bHxW11A2iSamuuIiHdrdAjDNR8CXe8qKfM3xI-lwDG5MwaElfpQ1E2Lg7DdGOdOJZtNOw=="></script><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/AGSKWxWioaKXj3803mjqPEjBI6yUOSGz27vDeRaZ3l_OATvQsdTlE9L9jzpVR0kLgKYbipUa-UWQbFLPQ7PfqCGeo0sL1nOjYp658OSIL3WaCh0nO0z7ZS3VF-nE7l0giRajsQG1hJe7Fg=="></script><link rel="stylesheet" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/codemirror.css"><link rel="stylesheet" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/styles(1).css"><link rel="stylesheet" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/froala_editor.pkgd.min.css"><link rel="stylesheet" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/gray.min.css"><link rel="stylesheet" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/mini-profile.css"><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/lazysizes.min.js.download"></script><script id="omapi-script" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/api.min.js.download" async=""></script><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/codeblocks.js.download"></script><link rel="stylesheet" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/api.min.css" id="omapi-css" media="all"><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/activity-bar.js.download"></script><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/froala_editor.pkgd.min.js.download"></script><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/content.js.download"></script><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/content(1).js.download"></script><script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/content(2).js.download"></script><script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/AGSKWxUsD239F0Qjvtzr8O2DoRGYQf_Ci3If1chCokVk_vrcigZ2PLzT7dNet2rI60EDZDL6GDNXQUIANwteaSAQNu8_AF2SJhwnGyDvgkd_dCnZzYCh1XMNI0xVG7ulihMjfannKkEweA=="></script></head>
<body x-data="" class="skybox-auto-collapse" style="overflow-y: auto;">
    <div class="skybox skybox-closeBtn" data-gpt-slot="skybox" id="div-gpt-ad-1435246566686-99" data-google-query-id="CNX46La86IsDFTKQ_QcdxQgicw" style="display: none;"><div id="google_ads_iframe_/5055/dz_skybox_0__container__" style="border: 0pt none; width: 5px; height: 5px;"></div></div>
<header id="ftl-header">
    <div class="header-top">
<div class="header-container">
    <div class="pull-left logo-container">
        <div class="logo">
            <a class="inner" href="https://dzone.com/">
                <picture>
                    <source srcset="https://dz2cdn1.dzone.com/themes/dz20/images/dz_logo_2021_cropped.webp" type="image/webp">
                    <source srcset="https://dz2cdn1.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" type="image/png">
                    <img src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/dz_logo_2021_cropped.png" width="181" height="56" alt="DZone">
                </picture>
            </a>
        </div>
    </div>

    <div class="pull-right login-and-search">
        <div id="authenticated-block" class="logged-in">
            <div class="welcome-back">Thanks for visiting DZone today,</div>
            <div id="user-header" class="user-info">
                <button class="user-avatar">
                    <span id="header-username" class="username"></span>
                    <img id="header-avatar" src="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2" alt="user avatar">
                </button>
                <div id="user-dropdown" class="browse-user-menu">
                    <div class="user-content">
                        <a id="header-user-plug" href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2#" class="user-description"></a>
                        <a id="header-user-edit" href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2#" class="edit-profile">Edit Profile</a>
                    </div>
                    <ul class="user-actions">
                        <li id="first-user-action">
                            <a id="header-dropdown-manage-email" href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2#">Manage Email Subscriptions</a>
                        </li>
                        <li>
                            <a href="https://dzone.com/articles/how-to-submit-a-post-to-dzone?utm_source=DZone&amp;utm_medium=user_dropdown&amp;utm_campaign=how_to_post">
                                How to Post to DZone
                            </a>
                        </li>
                        <li>
                            <a href="https://dzone.com/articles/dzones-article-submission-guidelines">
                                Article Submission Guidelines
                            </a>
                        </li>
                    </ul>
                    <div class="bottom">
                        <a href="https://dzone.com/users/logout.html" class="sign-out">Sign Out</a>
                        <a id="dropdown-view-profile" href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2#" class="view-profile">View Profile</a>
                    </div>
                </div>
            </div>

            <div class="post-content">
                <button id="post-button" class="post-content--button">
                    <span class="post-class">Post</span>
                    <i class="icon-plus"></i>
                </button>

                <div id="post-menu" class="posting-links">
                    <div class="posting-links-menu">
                        <ul>
                            <li>
                                <img src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/dz-postarticle.svg" width="15" height="18" style="width: 15px; height: 18px;">
                                <a href="https://dzone.com/content/article/post.html">Post an Article</a>
                            </li>
                            <li>
                                <a id="drafts-link" href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2#">Manage My Drafts</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="unauthenticated-block" class="shown">
            <div class="dz-intro">Over 2 million developers have joined DZone.</div>
            <div class="mobile-invisible sign-in-join">
                <a href="https://dzone.com/users/login.html">Log In</a>
                <span class="dz-intro-span">/</span>
                <a href="https://dzone.com/static/registration.html">Join</a>
            </div>
            <a class="join-icon" href="https://dzone.com/users/login.html"><i class="icon-user"></i></a>
        </div>

        <script>
            document.addEventListener('alpine:init', () => {
                Alpine.data('searchDrawer', () => ({
                    open: false,
                    query: '',
                    minCharsMet: false,

                    toggleVisibility() {
                        this.open = !this.open;
                        if (this.open) {
                            this.$nextTick(() => {
                                this.$refs.query.focus();
                            });
                        }
                    },

                    updateSearchValue() {
                        if (!this.query || !this.query.length || this.query.length < 3) {
                            this.minCharsMet = false;
                            return;
                        }
                        this.minCharsMet = true;
                        localStorage.setItem('ls.searchValue', this.query);
                    },

                    searchSite() {
                        if (this.minCharsMet) {
                            window.location = '/search';
                        }
                    }
                }));
            });
        </script>

        <div class="headerSearch" x-data="searchDrawer()">
            <button class="icon-search dropdown-toggle" x-on:click="toggleVisibility()"></button>
            <template x-teleport=".header-container" data-teleport-template="true"></template>
        </div>
    </div>
<div id="search-drawer" x-show="open" x-on:click.outside="open = false" x-transition="" data-teleport-target="true" style="display: none;">
                    <div class="search-input">
                        <input type="text" placeholder="Search" autofocus="autofocus" x-model="query" x-ref="query" x-on:input.change="updateSearchValue()" x-on:keyup.enter="searchSite()">
                        <button x-on:click="searchSite()" x-bind:disabled="!minCharsMet" disabled="disabled">
                            <span>Search</span>
                        </button>
                    </div>
                    <div class="search-footer">
                        Please enter at least three characters to search
                    </div>
                </div></div>    </div>
    <div class="header-bottom">
        <div class="header-bottom-container">
            <a class="resource-link" href="https://dzone.com/refcardz">Refcards</a>
            <a class="resource-link" href="https://dzone.com/trendreports">Trend Reports</a>
            <div class="resource-link link-menu">
                <a href="https://dzone.com/events">Events</a>
                <a href="https://dzone.com/events/video-library">Video Library</a>
            </div>
        </div>
    </div>
    <nav class="header-menu-bar">
        <div class="header-menu resource-category">
            <a href="https://dzone.com/refcardz">Refcards</a>
        </div>
        <div class="header-menu-separator resource-category-separator"></div>
        <div class="header-menu resource-category">
            <a href="https://dzone.com/trendreports">Trend Reports</a>
        </div>
        <div class="header-menu-separator resource-category-separator"></div>
        <div class="header-menu resource-category no-bottom-radius" tabindex="1" data-click-activation="">
            <p class="menu-label">Events</p>
            <div class="header-menu-items" style="display: none;">
                <div class="header-menu-columns">
                    <a class="header-menu-item" href="https://dzone.com/events">View Events</a>
                    <a class="header-menu-item" href="https://dzone.com/events/video-library">Video Library</a>
                </div>
            </div>
        </div>
            <div class="header-menu zone-menu" tabindex="1" data-click-activation="">
                <p class="menu-label">Zones <i class="icon-down-dir icon-closed"></i><i class="icon-right-dir icon-open"></i></p>
                <div class="header-menu-items" style="display: none;">
                    <div class="header-menu-columns">
                            <div class="header-menu-column-item">
                                <a class="header-menu-item" href="https://dzone.com/culture-and-methodologies">Culture and Methodologies</a>
                                        <a class="header-menu-item" href="https://dzone.com/agile">Agile</a>
                                        <a class="header-menu-item" href="https://dzone.com/career-development">Career Development</a>
                                        <a class="header-menu-item" href="https://dzone.com/methodologies">Methodologies</a>
                                        <a class="header-menu-item" href="https://dzone.com/team-management">Team Management</a>
                            </div>
                            <div class="header-menu-column-item">
                                <a class="header-menu-item" href="https://dzone.com/data-engineering">Data Engineering</a>
                                        <a class="header-menu-item" href="https://dzone.com/ai-ml">AI/ML</a>
                                        <a class="header-menu-item" href="https://dzone.com/big-data">Big Data</a>
                                        <a class="header-menu-item" href="https://dzone.com/data">Data</a>
                                        <a class="header-menu-item" href="https://dzone.com/databases">Databases</a>
                                        <a class="header-menu-item" href="https://dzone.com/iot">IoT</a>
                            </div>
                            <div class="header-menu-column-item">
                                <a class="header-menu-item" href="https://dzone.com/software-design-and-architecture">Software Design and Architecture</a>
                                        <a class="header-menu-item" href="https://dzone.com/cloud-architecture">Cloud Architecture</a>
                                        <a class="header-menu-item" href="https://dzone.com/containers">Containers</a>
                                        <a class="header-menu-item" href="https://dzone.com/integration">Integration</a>
                                        <a class="header-menu-item" href="https://dzone.com/microservices">Microservices</a>
                                        <a class="header-menu-item" href="https://dzone.com/performance">Performance</a>
                                        <a class="header-menu-item" href="https://dzone.com/security">Security</a>
                            </div>
                            <div class="header-menu-column-item">
                                <a class="header-menu-item" href="https://dzone.com/coding">Coding</a>
                                        <a class="header-menu-item" href="https://dzone.com/frameworks">Frameworks</a>
                                        <a class="header-menu-item" href="https://dzone.com/java">Java</a>
                                        <a class="header-menu-item" href="https://dzone.com/javascript">JavaScript</a>
                                        <a class="header-menu-item" href="https://dzone.com/languages">Languages</a>
                                        <a class="header-menu-item" href="https://dzone.com/tools">Tools</a>
                            </div>
                            <div class="header-menu-column-item">
                                <a class="header-menu-item" href="https://dzone.com/testing-deployment-and-maintenance">Testing, Deployment, and Maintenance</a>
                                        <a class="header-menu-item" href="https://dzone.com/deployment">Deployment</a>
                                        <a class="header-menu-item" href="https://dzone.com/devops-and-cicd">DevOps and CI/CD</a>
                                        <a class="header-menu-item" href="https://dzone.com/maintenance">Maintenance</a>
                                        <a class="header-menu-item" href="https://dzone.com/monitoring-and-observability">Monitoring and Observability</a>
                                        <a class="header-menu-item" href="https://dzone.com/testing-tools-and-frameworks">Testing, Tools, and Frameworks</a>
                            </div>
                    </div>
                </div>
            </div>
                <div class="header-menu parent-category" tabindex="1">
                    <a href="https://dzone.com/culture-and-methodologies">Culture and Methodologies</a>
                    <div class="header-menu-items" style="display: none;">
                                <a class="header-menu-item" href="https://dzone.com/agile">Agile</a>
                                <a class="header-menu-item" href="https://dzone.com/career-development">Career Development</a>
                                <a class="header-menu-item" href="https://dzone.com/methodologies">Methodologies</a>
                                <a class="header-menu-item" href="https://dzone.com/team-management">Team Management</a>
                    </div>
                </div>
                <div class="header-menu-separator parent-category-separator"></div>
                <div class="header-menu parent-category" tabindex="2">
                    <a href="https://dzone.com/data-engineering">Data Engineering</a>
                    <div class="header-menu-items" style="display: none;">
                                <a class="header-menu-item" href="https://dzone.com/ai-ml">AI/ML</a>
                                <a class="header-menu-item" href="https://dzone.com/big-data">Big Data</a>
                                <a class="header-menu-item" href="https://dzone.com/data">Data</a>
                                <a class="header-menu-item" href="https://dzone.com/databases">Databases</a>
                                <a class="header-menu-item" href="https://dzone.com/iot">IoT</a>
                    </div>
                </div>
                <div class="header-menu-separator parent-category-separator"></div>
                <div class="header-menu parent-category" tabindex="3">
                    <a href="https://dzone.com/software-design-and-architecture">Software Design and Architecture</a>
                    <div class="header-menu-items" style="display: none;">
                                <a class="header-menu-item" href="https://dzone.com/cloud-architecture">Cloud Architecture</a>
                                <a class="header-menu-item" href="https://dzone.com/containers">Containers</a>
                                <a class="header-menu-item" href="https://dzone.com/integration">Integration</a>
                                <a class="header-menu-item" href="https://dzone.com/microservices">Microservices</a>
                                <a class="header-menu-item" href="https://dzone.com/performance">Performance</a>
                                <a class="header-menu-item" href="https://dzone.com/security">Security</a>
                    </div>
                </div>
                <div class="header-menu-separator parent-category-separator"></div>
                <div class="header-menu parent-category" tabindex="4">
                    <a href="https://dzone.com/coding">Coding</a>
                    <div class="header-menu-items" style="display: none;">
                                <a class="header-menu-item" href="https://dzone.com/frameworks">Frameworks</a>
                                <a class="header-menu-item" href="https://dzone.com/java">Java</a>
                                <a class="header-menu-item" href="https://dzone.com/javascript">JavaScript</a>
                                <a class="header-menu-item" href="https://dzone.com/languages">Languages</a>
                                <a class="header-menu-item" href="https://dzone.com/tools">Tools</a>
                    </div>
                </div>
                <div class="header-menu-separator parent-category-separator"></div>
                <div class="header-menu parent-category" tabindex="5">
                    <a href="https://dzone.com/testing-deployment-and-maintenance">Testing, Deployment, and Maintenance</a>
                    <div class="header-menu-items" style="display: none;">
                                <a class="header-menu-item" href="https://dzone.com/deployment">Deployment</a>
                                <a class="header-menu-item" href="https://dzone.com/devops-and-cicd">DevOps and CI/CD</a>
                                <a class="header-menu-item" href="https://dzone.com/maintenance">Maintenance</a>
                                <a class="header-menu-item" href="https://dzone.com/monitoring-and-observability">Monitoring and Observability</a>
                                <a class="header-menu-item" href="https://dzone.com/testing-tools-and-frameworks">Testing, Tools, and Frameworks</a>
                    </div>
                </div>
                <div class="header-menu-separator parent-category-separator"></div>
    </nav>
</header>

<script>
    const csrf = {
        parameter: 'TH_CSRF',
        header: 'X-TH-CSRF',
        token: '-4442032967882974298'
    }; // set csrf for auth-status script
</script>
<script>
addEventListener('DOMContentLoaded', function() {
    handleRedirects();
    handleMenus();
    handleMobileMenuHeights();
    handleGotoLinks();
});

function isHidden(element) {
    try {
        return window.getComputedStyle(element).display === 'none';
    } catch (_) {
        return false;
    }
}

function getLink(element) {
    if (element.hasAttribute('data-goto')) {
        return element.getAttribute('data-goto');
    }
    return element.href;
}

function isLeftClick(event) {
    if (event.altKey || event.shiftKey) {
        return false;
    } else if ('buttons' in event || 'which' in event) {
        return event.buttons === 1 || event.which === 1;
    } else {
        return (event.button === 1 || (event.type === 'click'));
    }
}

function handleRedirects() {
    const redirections = [...document.querySelectorAll('[data-activate-menu]'), ...document.querySelectorAll('[data-click-target]')];

    redirections.forEach(function(element) {
        const menuSelector = element.getAttribute('data-activate-menu') || element.getAttribute('data-click-target');
        const redirectingElement = document.querySelector(menuSelector);
        if (redirectingElement) {
            element.style.cursor = 'pointer';
            const redirect = function(e) {
                if (redirectingElement.hasAttribute('href') || redirectingElement.hasAttribute('data-goto')) {
                    if (redirectingElement.hasAttribute('data-new-window') || e.ctrlKey || e.metaKey) {
                        window.open(getLink(redirectingElement), '_blank');
                    } else {
                        window.open(getLink(redirectingElement), '_self');
                    }
                } else {
                    const evt = new e.constructor(e.type, e);
                    redirectingElement.dispatchEvent(evt);
                }
            };
            element.addEventListener('mouseup', redirect);
            element.addEventListener('mousedown', (e) => e.preventDefault());
            element.addEventListener('click', (e) => e.preventDefault());
        }
    });
}

function handleMenus() {
    const menuElements = [
        ...document.querySelectorAll('.header-menu > a'),
        ...document.querySelectorAll('.header-menu > p.menu-label')
    ];

    let scrollYMemory = -1;

    function scrollToMemory() {
        if (scrollYMemory !== -1) {
            setTimeout(function() {
                window.scrollTo(0, scrollYMemory);
                scrollYMemory = -1;
            }, 10);
        }
    }

    function hideMenus() {
        // unfocus menus & items, and set the menus to non-visible.
        menuElements.forEach(function (element) {
            element.blur();
            element.parentElement.blur();
            element.parentElement.classList.remove('menu-opened');
            const menuItems = element.parentElement.querySelector('.header-menu-items');
            if (menuItems) {
                menuItems.style.display = 'none';
            }
        });
        const wasHidden = document.body.style.overflowY === 'hidden';
        document.body.style.overflowY = 'auto';
        if (wasHidden) {
            scrollToMemory();
        }
    }

    function isEventOutsideMenu(e) {
        return e.target.closest && !e.target.closest('.header-menu') && !e.target.closest('[data-activate-menu]');
    }

    // Handle mobile menu toggling
    menuElements.forEach(function(element) {
        const menu = element.parentElement;
        const headerItems = menu.querySelector('.header-menu-items');
        const menuEntries = headerItems ? headerItems.querySelectorAll('.header-menu-item') : [];

        const focus = function() {
            menu.focus();
            menu.classList.add('menu-opened');
            if (headerItems) {
                headerItems.style.display = 'block';
            }
            if (menu.classList.contains('zone-menu')) {
                scrollYMemory = window.scrollY;
                document.body.style.overflowY = 'hidden';
            } else {
                scrollYMemory = -1;
            }
        };

        const unfocus = function() {
            menu.blur();
            menu.classList.remove('menu-opened');
            if (headerItems) {
                headerItems.style.display = 'none';
            }
            const wasHidden = document.body.style.overflowY === 'hidden';
            document.body.style.overflowY = 'auto';
            if (wasHidden) {
                scrollToMemory();
            }
        };

        const toggleMenuVisibility = function(e) {
            if ((e.type === 'click' || e.type === 'mouseup') && !isLeftClick(e)) {
                e.preventDefault();
                return;
            }
            const hidden = isHidden(headerItems);
            if (menu.hasAttribute('data-click-activation')) { // handle click activated toggling
                if (hidden) {
                    hideMenus(); // hide other open menus first
                    focus();
                } else {
                    unfocus();
                }
                e.preventDefault();
            } else if (hidden) {
                hideMenus(); // hide other open menus first
                focus();
                e.preventDefault(); // prevent 'click' event from firing when menu is hidden
            }
        };

        element.addEventListener('touchend', toggleMenuVisibility);
        element.addEventListener('mouseup', toggleMenuVisibility);

        // Add hover events to non-click-activated menus, even though CSS should cover it.
        if (!menu.hasAttribute('data-click-activation')) {
            menu.addEventListener('mouseover', function () {
                hideMenus(); // hide other open menus first
                focus();
            });

            menu.addEventListener('mouseout', function (e) {
                if (isEventOutsideMenu(e)) {
                    unfocus();
                }
            });
        }

        // Hide menu when child is clicked
        menuEntries.forEach(function(menuEntry) {
            const linkToItem = function(e) {
                if (e.type === 'mousedown' || e.type === 'click') {
                    e.preventDefault();
                    return;
                }
                if (e.type === 'mouseup' && !isLeftClick(e)) {
                    e.preventDefault();
                    return;
                }
                window.open(getLink(menuEntry), (e.ctrlKey || e.metaKey) ? '_blank' : (menuEntry.target || '_self'));
                unfocus();
                e.preventDefault();
            };

            const linkToMobileItem = function(e) {
                if (e.type === 'touchstart') {
                    menuEntry.setAttribute('data-touchmove', false);
                } else if (e.type === 'touchmove') {
                    menuEntry.setAttribute('data-touchmove', true);
                } else if (e.type === 'touchend' && (!menuEntry.hasAttribute('data-touchmove') || menuEntry.getAttribute('data-touchmove').toLowerCase() === 'false')) {
                    window.open(getLink(menuEntry), (e.ctrlKey || e.metaKey) ? '_blank' : (menuEntry.target || '_self'));
                    unfocus();
                    e.preventDefault();
                }
            };

            menuEntry.addEventListener('mousedown', linkToItem);
            menuEntry.addEventListener('mouseup', linkToItem);
            menuEntry.addEventListener('click', linkToItem);
            menuEntry.addEventListener('touchstart', linkToMobileItem);
            menuEntry.addEventListener('touchmove', linkToMobileItem);
            menuEntry.addEventListener('touchend', linkToMobileItem);
        });
    });

    function hideIfNonMenuBounds(e) {
        if (isEventOutsideMenu(e)) {
            hideMenus();
        }
    }

    addEventListener('mousemove', hideIfNonMenuBounds);
    addEventListener('touchend', hideIfNonMenuBounds);
    addEventListener('mouseup', hideIfNonMenuBounds);
    addEventListener('mousedown', hideIfNonMenuBounds);
    addEventListener('click', hideIfNonMenuBounds);
}

function handleMobileMenuHeights() {
    function setAppHeight() {
        document.documentElement.style.setProperty('--app-height', window.innerHeight + 'px');
    }

    addEventListener('resize', function() {
        setAppHeight();
    });

    setAppHeight();
}

function handleGotoLinks() {
    // Add anchor mimicking to elements with data-goto attributes
    // This addresses SEO concerns of linking to noindex pages by allowing JS to handle the URL
    const anchorElements = document.querySelectorAll('*[data-goto]');
    anchorElements.forEach((anchorElement) => {
        anchorElement.addEventListener('mouseover', () => {
            anchorElement.style.cursor = 'pointer';
            anchorElement.style.textDecoration = 'underline';
        });
        anchorElement.addEventListener('mouseout', () => {
            anchorElement.style.cursor = 'unset';
            anchorElement.style.textDecoration = 'unset';
        });
        anchorElement.addEventListener('mouseup', (e) => {
            e.preventDefault();
        });
        anchorElement.addEventListener('mousedown', (e) => {
            e.preventDefault();
        });
        anchorElement.addEventListener('click', (e) => {
            e.preventDefault();
            const anchorHref = anchorElement.getAttribute('data-goto');
            if (anchorElement.hasAttribute('data-new-window') || e.ctrlKey || e.metaKey) {
                window.open(anchorHref, '_blank');
            } else {
                window.open(anchorHref, '_self');
            }
        });
    });
}
</script><script>
const authenticatedBlock = document.querySelector('#authenticated-block');
const unauthenticatedBlock = document.querySelector('#unauthenticated-block');

let authenticated = {
    isAuthenticated: false,
    isAdmin: false,
	user: {
		id: null,
		name: null,
		url: null,
		profileImage: null,
	}
};

fetch('/services/internal/data/articles-getAuthenticationStatus', {
    headers: {
        'Accept': 'application/json'
    }
})
    .then(function (result) {
        return result.json()
    })
    .then(function (result) {
        const res = result.result.data
        if (!res.authenticated) {
            unauthenticatedBlock.classList.add('shown')
        } else {
			authenticated.user.id = res.id;
			authenticated.user.name = res.realName;
			authenticated.user.url = res.profileUrl;
			authenticated.user.profileImage = res.avatar;
			authenticated.user.jobTitle = res.jobTitle;
			authenticated.user.companyName = res.companyName;

            bindProps('#header-username', null, null, (res.firstName || res.username), null)
            bindProps('#header-avatar', null, res.avatar, null, null)
            bindProps('#header-user-plug', res.profileUrl, null, res.realName, null)
            bindProps('#header-user-edit', '/users/' + res.id + '/edit.html', null, null, null)
            bindProps('#header-dropdown-manage-email', '/newsletters/' + res.id + '/manage.html', null, null, null)
            bindProps('#dropdown-view-profile', res.profileUrl, null, null, null)
            bindProps('#drafts-link', '/users/' + res.id + '/drafts.html', null, null, null)

            if (res.isAdmin) {
                // Construct backwards so the #after call places elements in the correct order
                const firstUserAction = document.querySelector('#first-user-action')
                const adminConsoleItem = document.createElement('li')
                const adminConsoleLink = createLink('/dzone/staff/index.html', 'Admin Console')
                adminConsoleItem.appendChild(adminConsoleLink)
                firstUserAction.after(adminConsoleItem)

                const moderationItem = document.createElement('li')
                const moderationLink = createLink('/moderation/list.html', 'Moderation')
                moderationItem.appendChild(moderationLink)
                firstUserAction.after(moderationItem)

	            const bountyModerationItem = document.createElement('li')
	            const bountyModerationLink = createLink('/moderation/bounties', 'Bounty Moderation')
	            bountyModerationItem.appendChild(bountyModerationLink)
	            firstUserAction.after(bountyModerationItem)
            }

            authenticated.isAuthenticated = res.authenticated;
            authenticated.isAdmin = res.isAdmin;

            authenticatedBlock.classList.add('shown')
        }
    }).catch(function (result) {
        console.error(result)
})

/**
 * Binds different properties to the selected element.
 *
 * @param selector - Selector to select the element
 * @param href - href attribute value
 * @param src - src attribute value
 * @param innerHTML - innerHTML property value
 * @param innerText - innerText property value
 */
function bindProps(selector, href, src, innerHTML, innerText) {
    const element = document.querySelector(selector)
    if (element) {
        if (href) element.href = href
        if (src) element.src = src
        if (innerHTML) element.innerHTML = innerHTML
        if (innerText) element.innerText = innerText
    }
}

/**
 * Creates a new link element.
 *
 * @param href - href attribute value
 * @param innerText - innerText property value
 * @returns {HTMLAnchorElement} The generated link element
 */
function createLink(href, innerText) {
    const link = document.createElement('a')
    link.href = href
    link.innerText = innerText

    return link
}
</script><script>
const userHeader = document.querySelector('#user-header')
const userDropdown = document.querySelector('#user-dropdown')
const postDropdown = document.querySelector('#post-button')
const postMenu = document.querySelector('#post-menu')

let userDropdownOpen = false
let postDropdownOpen = false

document.addEventListener('click', function(event) {
    if (postDropdown && postDropdown.contains(event.target)) {
        setUserDropdown(false)
        setPostDropdown(!postDropdownOpen)
    } else if (userHeader && userHeader.contains(event.target)) {
        setPostDropdown(false)
        setUserDropdown(!userDropdownOpen)
    } else {
        setUserDropdown(false)
        setPostDropdown(false)
    }
})

function setUserDropdown(value) {
    userDropdownOpen = value
    if (userDropdownOpen) {
        if (userDropdown) {
            userDropdown.classList.add('open')
        }
    } else {
        if (userDropdown) {
            userDropdown.classList.remove('open')
        }
    }
}

function setPostDropdown(value) {
    postDropdownOpen = value
    if (postDropdownOpen) {
        if (postMenu) {
            postMenu.classList.add('open')
        }
    } else {
        if (postMenu) {
            postMenu.classList.remove('open')
        }
    }
}
</script><script>
	document.addEventListener("alpine:init", () => {
		Alpine.store('global', {
			executeHttp(path, body, method) {
				const options = {
					method: method,
					headers: {
						[csrf.header]: csrf.token
					}
				};

				if (method !== 'GET') {
					options.body = JSON.stringify(body);
					options.headers = {
						...options.headers,
						'Content-Type': 'application/json; charset=UTF-8'
					};
				}

				return new Promise((resolve, reject) => {
					fetch(path, options)
						.then(res => {
							if (!res.ok) {
								reject(res);
							} else {
								resolve(res);
							}
						})
						.catch(err => reject(err));
				});
			},
			getFromService(path) {
				return this.executeHttp(path, null, 'GET');
			},
			postToService(path, body = {}) {
				return this.executeHttp(path, body, 'POST');
			},
			putToService(path, body = {}) {
				return this.executeHttp(path, body, 'PUT');
			}
		});
	});
</script>
<link rel="stylesheet" media="all" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/colors.css">
<link rel="stylesheet" media="all" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/styles(2).css">




<div id="body-container">
		<div id="announcement-container-outer">
			<div id="announcement-previous">
				<i class="icon-angle-left"></i>
			</div>
			<div id="announcement-next">
				<i class="icon-angle-right"></i>
			</div>
			<div id="announcement-container" style="flex-direction: row;">
					<div class="announcement announcement-count-4" data-position="1" style="opacity: 1; display: flex;">
						<div class="body"><p><strong>Identity and access management</strong> is foundational to modern cybersecurity. Learn how to safeguard systems against unauthorized access and more.</p></div>
						<div class="spacer"></div>
						<a href="https://dzone.com/link/2025-rc-iam-announcement" target="_self">
							<button>⏩ Read the Refcard</button>
						</a>
					</div>
						<div class="separator"></div>
					<div class="announcement announcement-count-4" data-position="2" style="display: none; opacity: 0;">
						<div class="body"><p><strong>Developer Experience: </strong>Demand to support engineering teams has risen, and there is a shift from traditional DevOps to workflow improvements.</p></div>
						<div class="spacer"></div>
						<a href="https://dzone.com/link/2025-tr-devex-announcement" target="_self">
							<button>⬇️ Download the NEW Trend Report</button>
						</a>
					</div>
						<div class="separator"></div>
					<div class="announcement announcement-count-4" data-position="3" style="display: none; opacity: 0;">
						<div class="body"><p><strong>The future of AI-driven development.</strong> Join the discussion around insights on low code's and AI's roles in building mission-critical apps.</p></div>
						<div class="spacer"></div>
						<a href="https://cvent.me/qArnKL?utm_source=DZ+Announcements&amp;utm_medium=DZ&amp;utm_id=Outsystem+Ad+Promo" target="_blank">
							<button>⏳ Save Your Seat</button>
						</a>
					</div>
						<div class="separator"></div>
					<div class="announcement announcement-count-4" data-position="4" style="display: none; opacity: 0;">
						<div class="body"><p><strong>DevEx Roundtable:</strong> Join the discussion about the evolving needs of the developer from streamlined workflows to infrastructures investments.</p></div>
						<div class="spacer"></div>
						<a href="https://cvent.me/1kOaMb?utm_source=DevExVRDZoneSite&amp;utm_medium=DevExVRDZoneSite&amp;utm_campaign=DevExVRDZoneAnnouncementBar" target="_blank">
							<button>⭕ Save Your Seat</button>
						</a>
					</div>
			</div>
		</div>
	<script type="text/javascript" async="">
(function() {
    let announcementPosition = 1;
    let minAnnouncementPosition = -1;
    let maxAnnouncementPosition = -1;

    const announcementPrevBtn = document.querySelector('#announcement-previous');
    const announcementNextBtn = document.querySelector('#announcement-next');

    function withAnnouncements(callback) {
        const announcements = document.querySelectorAll('#announcement-container .announcement');
        for (let announcement of announcements) {
            callback(announcement);
        }
    }

    function initAnnouncementVars() {
        document.querySelector(':root').style.setProperty('--mobile-announcement-separator-width', '1px');
        withAnnouncements(function(announcement) {
            const pos = parseInt(announcement.getAttribute('data-position'));
            minAnnouncementPosition = minAnnouncementPosition === -1 ? pos : Math.min(minAnnouncementPosition, pos);
            maxAnnouncementPosition = maxAnnouncementPosition === -1 ? pos : Math.max(maxAnnouncementPosition, pos);
        });

        if (document.querySelector('.announcementBarContainer')) {
            document.querySelector(':root').style.setProperty('--body-top-padding', '0');
        }

        if (maxAnnouncementPosition <= 0) {
            document.querySelector(':root').style.setProperty('--body-top-padding', '0');
        }

        sizeToFullWhenOneEntryOnMobile();
    }

    function setAnnouncementPosition(position) {
        if (window.outerWidth >= 890) {
            return; // we do not need to change the position, since we can display everything on desktop.
        }

        // Make the announcement cyclical
        if (minAnnouncementPosition !== -1 && maxAnnouncementPosition !== -1) {
            if (position > maxAnnouncementPosition) {
                position = minAnnouncementPosition; // overflow to the first announcement
            } else if (position < minAnnouncementPosition) {
                position = maxAnnouncementPosition; // underflow to the last announcement
            }
            announcementPosition = position;
        }

        const shownAnnouncements = [];

        let reverseFlex = false; // should only be true when the first and last items are showing

        // Now that the position is valid, apply the transforms
        withAnnouncements(function(announcement) {
            const pos = parseInt(announcement.getAttribute('data-position'));
            const isWrapped = position === maxAnnouncementPosition && pos === minAnnouncementPosition; // showing first + last at same time
            const doesNextQualify = window.outerWidth >= 500 && (pos === position + 1 || isWrapped);

            if (pos === position || doesNextQualify) {
                shownAnnouncements.push(announcement);
            } else {
                announcement.style.display = 'none';
            }

            announcement.style.opacity = 0.0;

            if (isWrapped) {
                reverseFlex = true;
            }
        });

        for (let announcement of shownAnnouncements) {
            announcement.style.display = 'flex';
            announcement.style.opacity = 1.0;
        }

        const announcementContainer = document.querySelector('#announcement-container');
        if (announcementContainer) {
            announcementContainer.style.flexDirection = reverseFlex ? 'row-reverse' : 'row';
        }
    }

    function resetAnnouncements() {
        announcementPosition = 1;
        const announcementContainer = document.querySelector('#announcement-container');
        if (announcementContainer) {
            announcementContainer.style.flexDirection = 'row';
        }
        withAnnouncements(function(announcement) {
            announcement.style.opacity = 1.0;
            announcement.style.display = 'flex';
        });
    }

    function sizeToFullWhenOneEntryOnMobile() {
        if (maxAnnouncementPosition <= 2 && announcementPrevBtn && announcementNextBtn) {
            announcementPrevBtn.style.display = maxAnnouncementPosition === 2 && window.outerWidth < 500 ? 'flex' : 'none';
            announcementNextBtn.style.display = maxAnnouncementPosition === 2 && window.outerWidth < 500 ? 'flex' : 'none';
        }
        if (maxAnnouncementPosition === 1 && window.outerWidth >= 500 && window.outerWidth < 890) {
            document.querySelector(':root').style.setProperty('--mobile-announcement-separator-width', '0');
            document.querySelector('#announcement-container .announcement').style.maxWidth = '100%';
        }
    }

    function resetAnnouncementsOnResize() {
        announcementPosition = 1; // we want to reset the announcement position every resize
        if (window.outerWidth >= 890) { // 4 announcements can be shown (215px * 4) + separator padding
            resetAnnouncements();
        } else { // if we're still on mobile, set the position to normalize things after resize
            setAnnouncementPosition(announcementPosition);
            sizeToFullWhenOneEntryOnMobile();
        }
    }

    window.addEventListener('resize', resetAnnouncementsOnResize);

    initAnnouncementVars();
    setAnnouncementPosition(announcementPosition); // sets the min & max positions as well as initializes transforms

    if (announcementPrevBtn) {
        announcementPrevBtn.onclick = function() {
            setAnnouncementPosition(announcementPosition - 1);
        };
    }

    if (announcementNextBtn) {
        announcementNextBtn.onclick = function() {
            setAnnouncementPosition(announcementPosition + 1);
        };
    }
})();	</script>
  <div id="ftl-article" class="trending-article-body">
      <div class="trending-sidebar">
        <div class="trending">
          <h3>Related</h3>
          <div class="trending-separator"></div>
          <ul>
              <li class="item">
                <a href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-3" class="related-link">Deep Dive Into Apache Flink's TumblingWindow — Part 3</a>
              </li>
              <li class="item">
                <a href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow" class="related-link">Deep Dive Into Apache Flink's TumblingWindow - Part 1</a>
              </li>
              <li class="item">
                <a href="https://dzone.com/articles/apache-flink-full-checkpoint-vs-incremental-checkpoint" class="related-link">Apache Flink: Full Checkpoint vs Incremental Checkpoint</a>
              </li>
              <li class="item">
                <a href="https://dzone.com/articles/react-callback-refs-guide" class="related-link">React Callback Refs: What They Are and How to Use Them</a>
              </li>
          </ul>
        </div>
      </div>
    <div class="container-fluid body trending-article-fluid">
      <div class="row">
        <div class="col-md-12">
          <div class="articles-wrap">
                <div class="ad-container">
                  <div id="div-gpt-ad-1435246566686-0" class="ads-billboard-article" data-gpt-slot="top" data-google-query-id="CMWngLe86IsDFQbsuwgdxfcVSw"><div id="google_ads_iframe_/5055/dz2_article_billboard_new_0__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe frameborder="0" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/container.html" id="google_ads_iframe_/5055/dz2_article_billboard_new_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="728" height="90" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" data-google-container-id="2" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div>
                </div>


            <div class="article-stream widget-top-border">
                <div class="content-right-images">
                  <div id="div-gpt-ad-1435246566686-2" class="sidebar-ad" data-gpt-desktop="true" data-gpt-slot="sidebar1" data-gtm-vis-recent-on-screen6133197_649="11030" data-gtm-vis-first-on-screen6133197_649="11030" data-gtm-vis-total-visible-time6133197_649="10000" data-google-query-id="CJyx6ba86IsDFZbiuwgde-IqJg" data-gtm-vis-has-fired6133197_649="1"><div id="google_ads_iframe_/5055/dz2_article_halfpage_new_0__container__" style="border: 0pt none; display: inline-block; width: 300px; height: 600px;"><iframe frameborder="0" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/container(1).html" id="google_ads_iframe_/5055/dz2_article_halfpage_new_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="300" height="600" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" data-google-container-id="1" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div>
                    <div class="trending-separator"></div>
                    <div class="trending">
                      <h3>Trending</h3>
                      <ul>
                          <li class="item">
                            <a href="https://dzone.com/articles/delegated-chain-of-thought-architecture-decoupling" class="trending-link" target="_self">The Delegated Chain of Thought Architecture</a>
                          </li>
                          <li class="item">
                            <a href="https://dzone.com/articles/java-stream-api-things-developer-should-know" class="trending-link" target="_self">Java Stream API: 3 Things Every Developer Should Know About</a>
                          </li>
                          <li class="item">
                            <a href="https://dzone.com/articles/a-step-by-step-guide-to-enterprise-application-dev" class="trending-link" target="_self">A Step-by-Step Guide to Enterprise Application Development</a>
                          </li>
                          <li class="item">
                            <a href="https://dzone.com/articles/open-source-software-engineer-career" class="trending-link" target="_self">How Open Source Can Elevate Your Career as a Software Engineer</a>
                          </li>
                      </ul>
                    </div>
                </div>
                <script type="application/ld+json">
                  {
                    "@context": "https://schema.org",
                    "@type": "Article",
                    "headline": "Deep Dive Into Apache Flink's TumblingWindow — Part 2",
                    "author": [{"image":{"@type":"ImageObject","caption":"Preetdeep Kumar","url":"https://secure.gravatar.com/avatar/75e6adc297cc87f1ab9c58f383e3612a?d=identicon&r=PG"},"@type":"Person","worksFor":{"@type":"Organization","name":"Salesforce"},"name":"Preetdeep Kumar","description":"Technical Manager, Hands-on AWS Solution Architect, Backend development (Java and Python) with expertise in ETL systems, API design, Big Data Pipelines, and Observability","url":"https://dzone.com/authors/preetdeepshrivastava"}],
                    "audience": "software developers",
                    "keywords": "flink,streaming api,streaming analytics,flink api,big data,apache,apache flink",
                    "timeRequired": "PT6M",
                    "commentCount": 0,
                    "wordCount": "1318",
                    "accessMode": "textual, visual",
                    "datePublished": "2020-03-10T00:00:00Z",
                    "dateModified": "2020-03-27T00:00:00Z",
                    "articleSection": "big-data-analytics-tutorials-tools-news",
                    "publisher": {
                      "@type": "Organization",
                      "name": "DZone",
                      "url": "https://dzone.com",
                      "logo": {
                        "@type": "ImageObject",
                        "url": "https://dzone.com/themes/dz20/images/dz_logo_2021_cropped.png"
                      }
                    },
                    "articleBody": "In my previous post, I shared examples of how to define and use TumblingWindow in its default behavior. In this post, I am going to provide examples of overriding these defaults and handling late values. You may also like: Deep Dive Into Apache Flink's TumblingWindow — Part 1 Customizing Tumbling Window's Time Offset Let us take an example as shown below (continuing from the previous post where Flink stream execution environment object has been created and a simple integer generator is our source). Java xxxxxxxxxx 1 16 1 intStream 2 .windowAll( TumblingProcessingTimeWindows.of( Time.seconds( 5 ), Time.seconds( 2 ) ) ) 3 .process( new ProcessAllWindowFunction&lt;Integer, Integer ,TimeWindow&gt;() 4 {\u003C!-- --\u003E 5 @Override 6 public void process( Context arg0, Iterable&lt;Integer&gt; input, Collector&lt;Integer&gt; output ) throws Exception 7 {\u003C!-- --\u003E 8 logger.info( \"Computing sum for {}\", input ); 9 int sum = 0; 10 for(int i : input) {\u003C!-- --\u003E 11 sum += i; 12 } 13 output.collect( sum ); 14 } 15 }) 16 .print(); The only change here is Line #2 which now instead of using \"timeWindowAll( Time.seconds( 5 ) )\" is now using more detailed \"windowAll( TumblingProcessingTimeWindows.of( Time.seconds( 5 ), Time.seconds( 2 ) ) )\" TimeWindowAll() is a wrapper method and defaults to windowAll(TumblingProcessingTimeWindows.of(size)) i.e. A window of fixed size by time (this time is system's time where Flink job is running). Note — Flink has more than one notion of time which I will discuss later in this post. As I shared in the previous post, by default Flink starts window at clock boundary but using a second parameter to windowAll() we can customize the clock boundary. Following shows, sample run for above code Figure 1: Overriding default time offset Line #1 — #5 = Flink starts a window, collects integers. However, at 19:26:37, this window closure triggers and sum of [1,2,3,4] is printed at Line #6 Note — If the offset was not provided then Flink would have closed the window at \"19:26:35\". But since the offset was 2 seconds, it made the window end at extra 2 seconds beyond clock boundary. TumblingWindow With EventTime So far in our discussion, we have taken 'time' as the default system time where Flink is executing the job. However, in many use cases, we want to use actual time of event i.e. when the event was created at the event source. To handle such scenarios Flink supports 3 ways to handle 'time'. Let us look at Event Time and how it can be used in Flink. In Event time, elements are grouped into windows based on the timestamp of the element itself and not any system clock. Let us see an example. First I defined a simple POJO class named \"Element\" as follows. I have used lombok to generate getters/setters for me through annotations. Java xxxxxxxxxx 1 18 1 @Setter @Getter 2 public class Element 3 {\u003C!-- --\u003E 4 Integer value; 5 Long timestamp; 6 7 public Element( int counter, long currTime ) 8 {\u003C!-- --\u003E 9 this.value = counter; 10 this.timestamp = currTime; 11 } 12 13 @Override 14 public String toString() 15 {\u003C!-- --\u003E 16 return \"\" + value; 17 } 18 } Next, I define a simple Source class called \"ElementGeneratorSource\" which will create objects of type Element and assign random increasing timestamp. This is to ensure I do not produce an Element with matching system time. In practice, you would have the timestamp coming as part of the event itself. Java xxxxxxxxxx 1 41 1 class ElementGeneratorSource implements SourceFunction&lt;Element&gt; 2 {\u003C!-- --\u003E 3 volatile boolean isRunning = true; 4 final Logger logger = LoggerFactory.getLogger(ElementGeneratorSource.class); 5 6 @Override 7 public void run( SourceContext&lt;Element&gt; ctx ) throws Exception 8 {\u003C!-- --\u003E 9 int counter = 1; 10 11 // 20 seconds behind flink program's start time 12 long eventStartTime = System.currentTimeMillis() - 20000; 13 14 // create first event using above timestamp 15 Element element = new Element(counter++, eventStartTime); 16 17 while( isRunning ) 18 {\u003C!-- --\u003E 19 logger.info(\"Produced Element with value {} and timestamp {}\", element.getValue(), printTime(element.getTimestamp())); 20 21 ctx.collect( element ); 22 23 // create elements and assign timestamp with randomness so that they are not same as current system clock time 24 element = new Element(counter++, element.getTimestamp() + ThreadLocalRandom.current().nextLong( 1000, 6000 )); 25 26 Thread.sleep( 1000 ); 27 } 28 } 29 30 @Override 31 public void cancel() 32 {\u003C!-- --\u003E 33 isRunning = false; 34 } 35 36 // helper function to print epoch time in readable format 37 String printTime(long longValue) 38 {\u003C!-- --\u003E 39 return LocalDateTime.ofInstant(Instant.ofEpochMilli(longValue), ZoneId.systemDefault()).toString(); 40 } 41 } Now, let us define a pipeline to process these elements using TumblingEventTime Windows. (I have removed class and method declaration lines to focus on important code blocks.) Java x 34 1 StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment(); 2 3 // set to EventTime else it defaults to ProcessTime 4 env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime); 5 6 DataStreamSource&lt;Element&gt; elementStream = env.addSource( new ElementGeneratorSource() ); 7 8 elementStream 9 .assignTimestampsAndWatermarks( new AscendingTimestampExtractor&lt;Element&gt;() 10 {\u003C!-- --\u003E 11 @Override 12 public long extractAscendingTimestamp( Element element ) 13 {\u003C!-- --\u003E 14 return element.getTimestamp(); 15 } 16 }) 17 .windowAll( TumblingEventTimeWindows.of( Time.seconds( 10 ) ) ) 18 .process( new ProcessAllWindowFunction&lt;Element, Integer ,TimeWindow&gt;() 19 {\u003C!-- --\u003E 20 @Override 21 public void process( Context arg0, Iterable&lt;Element&gt; input, Collector&lt;Integer&gt; output ) throws Exception 22 {\u003C!-- --\u003E 23 logger.info( \"Computing sum for {}\", input ); 24 25 int sum = 0; 26 for(Element e : input) {\u003C!-- --\u003E 27 sum += e.getValue(); 28 } 29 output.collect( sum ); 30 } 31 }) 32 .print(); 33 34 env.execute(); Line #1 — Define a streaming execution environment to start with Flink streaming. Line #4 — Needs to be set to EventTime otherwise Flink will ignore timestamp inside elements and use the default system clock. Line #6 — Create a DataStream using the ElementGenerator as source (discussed earlier in this article) Line #9 — Before defining a window, I need to inform Flink how to get timestamp and watermark for each element it receives. In this example, I am using a very handy class \"AscendingTimestampExtractor\" which as per Flink doc is, \"A timestamp assigner and watermark generator for streams where timestamps are monotonously ascending. In this case, the local watermarks for the streams are easy to generate, because they strictly follow the timestamps.\" One more benefit of using this Flink-provided API is that it will generate a watermark for me. A watermark is a way for Flink to know when to close the current Window (last element belonging to a window has arrived). In short,assignTimestampsAndWatermarks()will allow Flink to know how to read the timestamp from event/element coming to Flink and most important, how to compute watermarks. Line #17 — Define a window of type TumblingEventTimeWindows with size as 10 seconds. The rest of the code is similar to previous where we sum the values and print it. Sample output of the above example Figure 2: Output of TumblingEventWindow Three elements are produced at Line #1, #2, #3 with timestamp different than that of the system clock. (the system clock time is printed first before log level). When 3rd element is produced at \"2020-02-22T22:22:02.495\", it triggers current window closure because watermark has been breached. With a 10 seconds TimeWindow, the end time here will be \"2020-02-22T22:21:59.000\". So the current window collects only the first two values. In the next run, the window will close at \"2020-02-22T22:22:09.000\" which means that value 3 and value 4 will be collected in a new window since Line #7 has an element with timestamp &gt;= current watermark. Conclusion In this article, we discussed overriding the default time clock boundary and how to work with TumblingEventTimeWindow. We also saw an example of assigning timestamp to elements. In the next part, I will share and discuss handling late elements that arrive after a watermark is generated for the current window. Further Reading Apache Flink Basic Transformation Example Log Analysis 101 With Apache Flink, Spring Boot, and ActiveMQ",
                    "mainEntityOfPage": {
                      "@type": "WebPage",
                      "@id": "https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2"
                    },
                    "image": {
                      "@type": "ImageObject",
                      "url": "https://dz2cdn1.dzone.com/storage/article-thumb/13170650-thumb.jpg"
                    }
                  }
                </script>

	<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "DZone",
            "item": "https://dzone.com"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Coding",
            "item": "https://dzone.com/coding"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "Java",
            "item": "https://dzone.com/java"
          },
          {
            "@type": "ListItem",
            "position": 4,
            "name": "Deep Dive Into Apache Flink's TumblingWindow — Part 2",
            "item": "https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2"
          }
      ]
    }

	</script>

              <article>
                <div class="content">
                  <div class="header">
	<ol class="breadcrumb">
				<li class="server"><a href="https://dzone.com/">DZone</a></li>
				<li class="server"><a href="https://dzone.com/coding">Coding</a></li>
				<li class="server"><a href="https://dzone.com/java">Java</a></li>
				<li class="active server">Deep Dive Into Apache Flink's TumblingWindow — Part 2</li>
	</ol>


                    <div class="header-title">
                      <div class="title">
                        <h1 class="article-title">Deep Dive Into Apache Flink's TumblingWindow — Part 2</h1>
                      </div>

                      <div class="subhead">
                        <h3>In this post, I am going to provide examples of overriding these TumblingWindow defaults and handling late values.</h3>
                      </div>

                      <div class="publish-meta">
                        By<span style="user-select: none;">&nbsp;</span>
  <div class="article-author-meta">
    <img src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/thumbnail" class="avatar" alt="Preetdeep Kumar user avatar" width="40">
    <div class="author-info">
      <span class="author-name">
        <a href="https://dzone.com/authors/preetdeepshrivastava">Preetdeep Kumar</a>
      </span>
    </div>



      <span class="badge-container badge-text-md">
        <img class="author-core-badge" width="18" height="18" alt="DZone Core" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/dz-core-icon.png" style="margin: 0 0 3px 2px">
        CORE
      </span>
    ·
  </div>
                        <span class="author-date">
                          Updated Mar. 27, 20
                        </span>
                        ·
                        <span>Analysis</span>
                      </div>
                    </div>
                  </div>

                  <div class="author-n-useraction">
                    <div class="like action" x-data="engagementModal(articleId)">
                      <span id="activity-like-icon" class="dz-like icon-thumbs-up" x-on:click="updateStore()"></span>
                      <span class="action-label like-text" x-on:click="open()">
                        <span>Likes</span>
                        <span id="activity-like-counter" class="like-count">(7)</span>
                      </span>
<template x-teleport="body" data-teleport-template="true"></template>                    </div>

                    <div class="action comment-action">
                      <span class="comment">
                        <i class="icon-comment"></i>
                        <span class="action-label">Comment</span>
                        <span id="activity-comment-counter" class="comment-count">(0)</span>
                      </span>
                    </div>

                    <div class="save action">
                      <div id="activity-save-icon" class="save icon-star-empty">
                        <span id="activity-save-text" class="action-label">Save</span>
                      </div>
                    </div>

                    <div class="tweet action">
                      <a id="tweet-link" href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2" class="title" target="_blank">
                        <span><i class="icon-twitter"></i></span>
                        <span class="action-label">Tweet</span>
                      </a>
                    </div>

                    <div class="linkedin action">
                      <a id="linkedin-link" href="https://www.linkedin.com/sharing/share-offsite/?url=https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2" class="title" target="_blank">
                        <span><i class="icon-linkedin-1"></i></span>
                        <span class="action-label">Share</span>
                      </a>
                    </div>

                    <div class="right-most">
                      <div id="activity-view-container" class="article-views action">
                        <i class="icon-eye"></i>
                        <span class="action-label view-count">14.8K Views</span>
                      </div>
                    </div>
                  </div>

                      <div class="signin-prompt">
                        <p>Join the DZone community and get the full member experience.</p>
                        <a id="article-signin-prompt" href="https://dzone.com/static/registration.html">Join For Free</a>
                      </div>
                      <div class="arrow-down"></div>

                    <div id="top-bumper-container"><div id="div-gpt-ad-1435246566686-3" class="article-bumper article-bumper-top" data-gpt-desktop="true" data-gpt-slot="topBumper" data-google-query-id="CKLf6La86IsDFa3BuwgdS2wONw"><div id="google_ads_iframe_/5055/dz2_bumper_text_ad_0__container__" style="border: 0pt none; display: inline-block; width: 100%; height: auto;"><iframe frameborder="0" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/container(2).html" id="google_ads_iframe_/5055/dz2_bumper_text_ad_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="0" height="103" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" data-google-container-id="3" style="border: 0px; vertical-align: bottom; min-width: 100%;" data-load-complete="true"></iframe></div></div></div>

                  <div>
                    <div class="content-html"><p>In my previous <a href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow" rel="noopener noreferrer" target="_blank">post</a>, I shared examples of how to define and use TumblingWindow in its default behavior. In this post, I am going to provide examples of overriding these defaults and handling late values.</p>
<blockquote>
 <p>You may also like: <a href="https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow" rel="noopener noreferrer" target="_blank">Deep Dive Into Apache Flink's TumblingWindow — Part 1</a></p>
</blockquote>
<h2>Customizing Tumbling Window's Time Offset</h2>
<p>Let us take an example as shown below (continuing from the previous post where Flink stream execution environment object has been created and a simple integer generator is our source).</p>
<div class="codeMirror-wrapper">
 <div contenteditable="false">
  <div class="codeHeader">
   <div class="nameLanguage">
    Java
   </div><i class="icon-cancel-circled-1 cm-remove">&nbsp;</i>
  </div>
  <div class="codeMirror-code--wrapper" data-code="intStream
.windowAll( TumblingProcessingTimeWindows.of( Time.seconds( 5 ), Time.seconds( 2 ) ) )
.process( new ProcessAllWindowFunction&lt;Integer, Integer ,TimeWindow&gt;()
{
  @Override
  public void process( Context arg0, Iterable&lt;Integer&gt; input, Collector&lt;Integer&gt; output ) throws Exception
  {
    logger.info( &quot;Computing sum for {}&quot;, input );
    int sum = 0;
    for(int i : input) {
      sum += i;
    }
    output.collect( sum );
  }
})
.print();" data-lang="text/x-java">
   <div class="CodeMirror cm-s-default CodeMirror-wrap">
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 36px;">
     <textarea spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0" value=""></textarea>
    </div>
    <div class="CodeMirror-vscrollbar" style="display: block; bottom: 0px;">
     <div style="min-width: 1px; height: 422px;">
      <br>
     </div>
    </div>
    <div class="CodeMirror-hscrollbar">
     <div style="height: 100%; min-height: 1px; width: 0px;">
      <br>
     </div>
    </div>
    <div class="CodeMirror-scrollbar-filler">
     <br>
    </div>
    <div class="CodeMirror-gutter-filler">
     <br>
    </div>
    <div class="CodeMirror-scroll" tabindex="-1">
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: -15px; border-right-width: 15px; min-height: 422px; padding-right: 15px; padding-bottom: 0px;">
      <div style="position: relative; top: 0px;">
       <div class="CodeMirror-lines">
        <div style="position: relative; outline: none;">
         <div class="CodeMirror-measure">
          <pre><span>xxxxxxxxxx</span></pre>
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
           <div>
            1
           </div>
          </div>
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
           <div>
            16
           </div>
          </div>
         </div>
         <div class="CodeMirror-measure">
          <br>
         </div>
         <div style="position: relative; z-index: 1;">
          <br>
         </div>
         <div class="CodeMirror-cursors">
          <div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 23px;">
           &nbsp;
          </div>
         </div>
         <div class="CodeMirror-code">
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             1
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">intStream</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             2
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">.<span class="cm-variable">windowAll</span>( <span class="cm-variable">TumblingProcessingTimeWindows</span>.<span class="cm-variable">of</span>( <span class="cm-variable">Time</span>.<span class="cm-variable">seconds</span>( <span class="cm-number">5</span> ), <span class="cm-variable">Time</span>.<span class="cm-variable">seconds</span>( <span class="cm-number">2</span> ) ) )</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             3
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">.<span class="cm-variable">process</span>( <span class="cm-keyword">new</span> <span class="cm-variable">ProcessAllWindowFunction</span><span class="cm-operator">&lt;</span><span class="cm-type">Integer</span>, <span class="cm-type">Integer</span> ,<span class="cm-variable">TimeWindow</span><span class="cm-operator">&gt;</span>()</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             4
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">{</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             5
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Override</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             6
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-type">void</span> <span class="cm-variable">process</span>( <span class="cm-variable">Context</span> <span class="cm-variable">arg0</span>, <span class="cm-variable">Iterable</span><span class="cm-operator">&lt;</span><span class="cm-type">Integer</span><span class="cm-operator">&gt;</span> <span class="cm-variable">input</span>, <span class="cm-variable">Collector</span><span class="cm-operator">&lt;</span><span class="cm-type">Integer</span><span class="cm-operator">&gt;</span> <span class="cm-variable">output</span> ) <span class="cm-keyword">throws</span> <span class="cm-variable">Exception</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             7
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             8
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">logger</span>.<span class="cm-variable">info</span>( <span class="cm-string">"Computing sum for {}"</span>, <span class="cm-variable">input</span> );</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             9
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">int</span> <span class="cm-variable">sum</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             10
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">for</span>(<span class="cm-type">int</span> <span class="cm-variable">i</span> : <span class="cm-variable">input</span>) {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             11
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">sum</span> <span class="cm-operator">+=</span> <span class="cm-variable">i</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             12
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             13
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">output</span>.<span class="cm-variable">collect</span>( <span class="cm-variable">sum</span> );</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             14
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             15
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">})</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             16
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">.<span class="cm-variable">print</span>();</span></pre>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 422px;">
      <br>
     </div>
     <div class="CodeMirror-gutters" style="height: 437px; left: 0px;">
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;">
       <br>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>
<p><br></p>
<p>The only change here is Line #2 which now instead of using <code>"timeWindowAll( Time.seconds( 5 ) )"</code><span id="_tmp_pre_1">&nbsp;</span>is now using more detailed <code>"windowAll( TumblingProcessingTimeWindows.of( Time.seconds( 5 ),&nbsp;</code></p>
<p><code>Time.seconds( 2 ) ) )"</code></p>
<p><em>TimeWindowAll()</em> is a wrapper method and defaults to <em>windowAll(TumblingProcessingTimeWindows.of(size))</em> i.e. A window of fixed size by time (this time is system's time where Flink job is running).</p>
<p><strong>Note —</strong> Flink has more than one notion of time which I will discuss later in this post.</p>
<p>As I shared in the previous post, by default Flink starts window at clock boundary but using a second parameter to <code>windowAll()</code><span id="_tmp_pre_1">&nbsp;</span>we can customize the clock boundary.</p>
<p>Following shows, sample run for above code</p>
<p><span class="fr-img-caption ls-is-cached lazyloaded fr-fic fr-dib fr-bordered" style="width: 824px;"><span class="fr-img-wrap"><img data-image="true" data-new="false" data-sizeformatted="133.3 kB" data-mimetype="image/png" data-creationdate="1581431014566" data-creationdateformatted="02/11/2020 02:23 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/13032760-1581431008077.png" data-modificationdate="null" data-size="133336" data-name="1581431008077.png" data-id="13032760" style="width: 824px;" data-src="https://dz2cdn1.dzone.com/storage/temp/13032760-1581431008077.png" class=" lazyloaded" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/1581431008077.png"></span></span></p>
<figcaption style="text-align:center;">
 <em>Figure 1: Overriding default time offset</em>
</figcaption>
<p>Line #1 — #5 = Flink starts a window, collects integers. However, at 19:26:37, this window closure triggers and sum of [1,2,3,4] is printed at Line #6</p>
<p><strong>Note —&nbsp;</strong>If the offset was not provided then Flink would have closed the window at "19:26:35". But since the offset was 2 seconds, it made the window end at extra 2 seconds beyond clock boundary.</p>
<h2>TumblingWindow With EventTime</h2>
<p>So far in our discussion, we have taken 'time' as the default system time where Flink is executing the job. However, in many use cases, we want to use actual time of event i.e. when the event was created at the event source. To handle such scenarios Flink supports <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.10/dev/event_time.html" rel="noopener noreferrer" target="_blank">3 ways to handle 'time'.</a> Let us look at <strong>Event Time</strong> and how it can be used in Flink.</p>
<p>In Event time, elements are grouped into windows based on the timestamp of the element itself and not any system clock. Let us see an example.</p>
<p>First I defined a simple POJO class named "Element" as follows. I have used <a href="https://projectlombok.org/" rel="noopener noreferrer" target="_blank">lombok</a> to generate getters/setters for me through annotations.</p>
<div class="codeMirror-wrapper">
 <div contenteditable="false">
  <div class="codeHeader">
   <div class="nameLanguage">
    Java
   </div><i class="icon-cancel-circled-1 cm-remove">&nbsp;</i>
  </div>
  <div class="codeMirror-code--wrapper" data-code="@Setter @Getter
public class Element
{
  Integer value;
  Long timestamp;

  public Element( int counter, long currTime )
  {
    this.value = counter;
    this.timestamp = currTime;
  }

  @Override
  public String toString()
  {
    return &quot;&quot; + value;
  }
}" data-lang="text/x-java">
   <div class="CodeMirror cm-s-default CodeMirror-wrap">
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 36px;">
     <textarea spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0" value=""></textarea>
    </div>
    <div class="CodeMirror-vscrollbar" style="display: block; bottom: 0px;">
     <div style="min-width: 1px; height: 422px;">
      <br>
     </div>
    </div>
    <div class="CodeMirror-hscrollbar">
     <div style="height: 100%; min-height: 1px; width: 0px;">
      <br>
     </div>
    </div>
    <div class="CodeMirror-scrollbar-filler">
     <br>
    </div>
    <div class="CodeMirror-gutter-filler">
     <br>
    </div>
    <div class="CodeMirror-scroll" tabindex="-1">
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: -15px; border-right-width: 15px; min-height: 422px; padding-right: 15px; padding-bottom: 0px;">
      <div style="position: relative; top: 0px;">
       <div class="CodeMirror-lines">
        <div style="position: relative; outline: none;">
         <div class="CodeMirror-measure">
          <pre><span>xxxxxxxxxx</span></pre>
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
           <div>
            1
           </div>
          </div>
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
           <div>
            18
           </div>
          </div>
         </div>
         <div class="CodeMirror-measure">
          <br>
         </div>
         <div style="position: relative; z-index: 1;">
          <br>
         </div>
         <div class="CodeMirror-cursors">
          <div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 23px;">
           &nbsp;
          </div>
         </div>
         <div class="CodeMirror-code">
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             1
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-meta">@Setter</span> <span class="cm-meta">@Getter</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             2
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">Element</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             3
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">{</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             4
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-type">Integer</span> <span class="cm-variable">value</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             5
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-type">Long</span> <span class="cm-variable">timestamp</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             6
            </div>
           </div>
           <pre class=" CodeMirror-line "></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             7
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-variable">Element</span>( <span class="cm-type">int</span> <span class="cm-variable">counter</span>, <span class="cm-type">long</span> <span class="cm-variable">currTime</span> )</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             8
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             9
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-variable">counter</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             10
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">this</span>.<span class="cm-variable">timestamp</span> <span class="cm-operator">=</span> <span class="cm-variable">currTime</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             11
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             12
            </div>
           </div>
           <pre class=" CodeMirror-line "></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             13
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Override</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             14
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-type">String</span> <span class="cm-variable">toString</span>()</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             15
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             16
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-string">""</span> <span class="cm-operator">+</span> <span class="cm-variable">value</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             17
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             18
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 422px;">
      <br>
     </div>
     <div class="CodeMirror-gutters" style="height: 437px; left: 0px;">
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;">
       <br>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>
<p><br></p>
<p>Next, I define a simple Source class called <strong>"ElementGeneratorSource"</strong> which will create objects of type Element and assign random increasing timestamp. This is to ensure I do not produce an Element with matching system time. In practice, you would have the timestamp coming as part of the event itself.</p>
<div class="codeMirror-wrapper">
 <div contenteditable="false">
  <div class="codeHeader">
   <div class="nameLanguage">
    Java
   </div><i class="icon-cancel-circled-1 cm-remove">&nbsp;</i>
  </div>
  <div class="codeMirror-code--wrapper" data-code="class ElementGeneratorSource implements SourceFunction&lt;Element&gt;
{
  volatile boolean isRunning = true;
  final Logger logger = LoggerFactory.getLogger(ElementGeneratorSource.class);
    
  @Override
  public void run( SourceContext&lt;Element&gt; ctx ) throws Exception
  {
    int counter = 1;    
    
    // 20 seconds behind flink program&#39;s start time
    long eventStartTime = System.currentTimeMillis() - 20000;
        
    // create first event using above timestamp
    Element element = new Element(counter++, eventStartTime);
                                      
    while( isRunning )
    {
      logger.info(&quot;Produced Element with value {} and timestamp {}&quot;, element.getValue(), printTime(element.getTimestamp()));
            
      ctx.collect( element );
            
      // create elements and assign timestamp with randomness so that they are not same as current system clock time
      element = new Element(counter++, element.getTimestamp() + ThreadLocalRandom.current().nextLong( 1000, 6000 ));
            
      Thread.sleep( 1000 );      
      }
    }

  @Override
  public void cancel()
  {
    isRunning = false;
  }
    
  // helper function to print epoch time in readable format  
  String printTime(long longValue)
  {
    return LocalDateTime.ofInstant(Instant.ofEpochMilli(longValue), ZoneId.systemDefault()).toString();
  }
}" data-lang="text/x-java">
   <div class="CodeMirror cm-s-default CodeMirror-wrap">
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 36px;">
     <textarea spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0" value=""></textarea>
    </div>
    <div class="CodeMirror-vscrollbar" style="display: block; bottom: 0px;">
     <div style="min-width: 1px; height: 1043px;">
      <br>
     </div>
    </div>
    <div class="CodeMirror-hscrollbar">
     <div style="height: 100%; min-height: 1px; width: 0px;">
      <br>
     </div>
    </div>
    <div class="CodeMirror-scrollbar-filler">
     <br>
    </div>
    <div class="CodeMirror-gutter-filler">
     <br>
    </div>
    <div class="CodeMirror-scroll" tabindex="-1">
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: -15px; border-right-width: 15px; min-height: 1043px; padding-right: 15px; padding-bottom: 0px;">
      <div style="position: relative; top: 0px;">
       <div class="CodeMirror-lines">
        <div style="position: relative; outline: none;">
         <div class="CodeMirror-measure">
          <pre><span>xxxxxxxxxx</span></pre>
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
           <div>
            1
           </div>
          </div>
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
           <div>
            41
           </div>
          </div>
         </div>
         <div class="CodeMirror-measure">
          <br>
         </div>
         <div style="position: relative; z-index: 1;">
          <br>
         </div>
         <div class="CodeMirror-cursors">
          <div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 23px;">
           &nbsp;
          </div>
         </div>
         <div class="CodeMirror-code">
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             1
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">ElementGeneratorSource</span> <span class="cm-keyword">implements</span> <span class="cm-variable">SourceFunction</span><span class="cm-operator">&lt;</span><span class="cm-variable">Element</span><span class="cm-operator">&gt;</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             2
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">{</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             3
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">volatile</span> <span class="cm-type">boolean</span> <span class="cm-variable">isRunning</span> <span class="cm-operator">=</span> <span class="cm-atom">true</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             4
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">final</span> <span class="cm-variable">Logger</span> <span class="cm-variable">logger</span> <span class="cm-operator">=</span> <span class="cm-variable">LoggerFactory</span>.<span class="cm-variable">getLogger</span>(<span class="cm-variable">ElementGeneratorSource</span>.<span class="cm-keyword">class</span>);</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             5
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             6
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Override</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             7
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-type">void</span> <span class="cm-variable">run</span>( <span class="cm-variable">SourceContext</span><span class="cm-operator">&lt;</span><span class="cm-variable">Element</span><span class="cm-operator">&gt;</span> <span class="cm-variable">ctx</span> ) <span class="cm-keyword">throws</span> <span class="cm-variable">Exception</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             8
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             9
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">int</span> <span class="cm-variable">counter</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             10
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             11
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 20 seconds behind flink program's start time</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             12
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">long</span> <span class="cm-variable">eventStartTime</span> <span class="cm-operator">=</span> <span class="cm-variable">System</span>.<span class="cm-variable">currentTimeMillis</span>() <span class="cm-operator">-</span> <span class="cm-number">20000</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             13
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             14
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// create first event using above timestamp</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             15
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">Element</span> <span class="cm-variable">element</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Element</span>(<span class="cm-variable">counter</span><span class="cm-operator">++</span>, <span class="cm-variable">eventStartTime</span>);</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             16
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             17
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">while</span>( <span class="cm-variable">isRunning</span> )</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             18
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             19
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">logger</span>.<span class="cm-variable">info</span>(<span class="cm-string">"Produced Element with value {} and timestamp {}"</span>, <span class="cm-variable">element</span>.<span class="cm-variable">getValue</span>(), <span class="cm-variable">printTime</span>(<span class="cm-variable">element</span>.<span class="cm-variable">getTimestamp</span>()));</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             20
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             21
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">ctx</span>.<span class="cm-variable">collect</span>( <span class="cm-variable">element</span> );</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             22
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             23
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-comment">// create elements and assign timestamp with randomness so that they are not same as current system clock time</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             24
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">element</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Element</span>(<span class="cm-variable">counter</span><span class="cm-operator">++</span>, <span class="cm-variable">element</span>.<span class="cm-variable">getTimestamp</span>() <span class="cm-operator">+</span> <span class="cm-variable">ThreadLocalRandom</span>.<span class="cm-variable">current</span>().<span class="cm-variable">nextLong</span>( <span class="cm-number">1000</span>, <span class="cm-number">6000</span> ));</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             25
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             26
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">Thread</span>.<span class="cm-variable">sleep</span>( <span class="cm-number">1000</span> ); &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             27
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             28
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             29
            </div>
           </div>
           <pre class=" CodeMirror-line "></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             30
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Override</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             31
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-type">void</span> <span class="cm-variable">cancel</span>()</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             32
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             33
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">isRunning</span> <span class="cm-operator">=</span> <span class="cm-atom">false</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             34
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             35
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             36
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// helper function to print epoch time in readable format &nbsp;</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             37
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-type">String</span> <span class="cm-variable">printTime</span>(<span class="cm-type">long</span> <span class="cm-variable">longValue</span>)</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             38
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             39
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">LocalDateTime</span>.<span class="cm-variable">ofInstant</span>(<span class="cm-variable">Instant</span>.<span class="cm-variable">ofEpochMilli</span>(<span class="cm-variable">longValue</span>), <span class="cm-variable">ZoneId</span>.<span class="cm-variable">systemDefault</span>()).<span class="cm-variable">toString</span>();</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             40
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             41
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 1043px;">
      <br>
     </div>
     <div class="CodeMirror-gutters" style="height: 1058px; left: 0px;">
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;">
       <br>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>
<p><br></p>
<p>Now, let us define a pipeline to process these elements using TumblingEventTime Windows. <em>(I have removed class and method declaration lines to focus on important code blocks.)</em></p>
<div class="codeMirror-wrapper">
 <div contenteditable="false">
  <div class="codeHeader">
   <div class="nameLanguage">
    Java
   </div><i class="icon-cancel-circled-1 cm-remove">&nbsp;</i>
  </div>
  <div class="codeMirror-code--wrapper" data-code="StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
  
// set to EventTime else it defaults to ProcessTime 
env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime);
  
DataStreamSource&lt;Element&gt; elementStream = env.addSource( new ElementGeneratorSource() );

elementStream
.assignTimestampsAndWatermarks( new AscendingTimestampExtractor&lt;Element&gt;()
{
  @Override
  public long extractAscendingTimestamp( Element element )
  {
    return element.getTimestamp();
  }
})        
.windowAll( TumblingEventTimeWindows.of( Time.seconds( 10 ) ) )        
.process( new ProcessAllWindowFunction&lt;Element, Integer ,TimeWindow&gt;()
{
  @Override
  public void process( Context arg0, Iterable&lt;Element&gt; input, Collector&lt;Integer&gt; output ) throws Exception
  {
    logger.info( &quot;Computing sum for {}&quot;, input );
                
    int sum = 0;
    for(Element e : input) {
      sum += e.getValue();
    }
    output.collect( sum );
  }
})
.print();
        
env.execute();" data-lang="text/x-java">
   <div class="CodeMirror cm-s-default CodeMirror-wrap">
    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 36px;">
     <textarea spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0" value=""></textarea>
    </div>
    <div class="CodeMirror-vscrollbar" style="display: block; bottom: 0px;">
     <div style="min-width: 1px; height: 859px;">
      <br>
     </div>
    </div>
    <div class="CodeMirror-hscrollbar">
     <div style="height: 100%; min-height: 1px; width: 0px;">
      <br>
     </div>
    </div>
    <div class="CodeMirror-scrollbar-filler">
     <br>
    </div>
    <div class="CodeMirror-gutter-filler">
     <br>
    </div>
    <div class="CodeMirror-scroll" tabindex="-1">
     <div class="CodeMirror-sizer" style="margin-left: 31px; margin-bottom: -15px; border-right-width: 15px; min-height: 859px; padding-right: 15px; padding-bottom: 0px;">
      <div style="position: relative; top: 0px;">
       <div class="CodeMirror-lines">
        <div style="position: relative; outline: none;">
         <div class="CodeMirror-measure">
          <span>x</span>
          <div class="CodeMirror-linenumber CodeMirror-gutter-elt">
           <div>
            34
           </div>
          </div>
         </div>
         <div class="CodeMirror-measure">
          <br>
         </div>
         <div style="position: relative; z-index: 1;">
          <br>
         </div>
         <div class="CodeMirror-cursors">
          <div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 22.5px;">
           &nbsp;
          </div>
         </div>
         <div class="CodeMirror-code">
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             1
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">StreamExecutionEnvironment</span> <span class="cm-variable">env</span> <span class="cm-operator">=</span> <span class="cm-variable">StreamExecutionEnvironment</span>.<span class="cm-variable">getExecutionEnvironment</span>();</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             2
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             3
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// set to EventTime else it defaults to ProcessTime </span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             4
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">env</span>.<span class="cm-variable">setStreamTimeCharacteristic</span>(<span class="cm-variable">TimeCharacteristic</span>.<span class="cm-variable">EventTime</span>);</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             5
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             6
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">DataStreamSource</span><span class="cm-operator">&lt;</span><span class="cm-variable">Element</span><span class="cm-operator">&gt;</span> <span class="cm-variable">elementStream</span> <span class="cm-operator">=</span> <span class="cm-variable">env</span>.<span class="cm-variable">addSource</span>( <span class="cm-keyword">new</span> <span class="cm-variable">ElementGeneratorSource</span>() );</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             7
            </div>
           </div>
           <pre class=" CodeMirror-line "></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             8
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">elementStream</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             9
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">.<span class="cm-variable">assignTimestampsAndWatermarks</span>( <span class="cm-keyword">new</span> <span class="cm-variable">AscendingTimestampExtractor</span><span class="cm-operator">&lt;</span><span class="cm-variable">Element</span><span class="cm-operator">&gt;</span>()</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             10
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">{</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             11
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Override</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             12
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-type">long</span> <span class="cm-variable">extractAscendingTimestamp</span>( <span class="cm-variable">Element</span> <span class="cm-variable">element</span> )</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             13
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             14
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">element</span>.<span class="cm-variable">getTimestamp</span>();</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             15
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             16
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}) &nbsp; &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             17
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">.<span class="cm-variable">windowAll</span>( <span class="cm-variable">TumblingEventTimeWindows</span>.<span class="cm-variable">of</span>( <span class="cm-variable">Time</span>.<span class="cm-variable">seconds</span>( <span class="cm-number">10</span> ) ) ) &nbsp; &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             18
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">.<span class="cm-variable">process</span>( <span class="cm-keyword">new</span> <span class="cm-variable">ProcessAllWindowFunction</span><span class="cm-operator">&lt;</span><span class="cm-variable">Element</span>, <span class="cm-type">Integer</span> ,<span class="cm-variable">TimeWindow</span><span class="cm-operator">&gt;</span>()</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             19
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">{</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             20
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@Override</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             21
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-type">void</span> <span class="cm-variable">process</span>( <span class="cm-variable">Context</span> <span class="cm-variable">arg0</span>, <span class="cm-variable">Iterable</span><span class="cm-operator">&lt;</span><span class="cm-variable">Element</span><span class="cm-operator">&gt;</span> <span class="cm-variable">input</span>, <span class="cm-variable">Collector</span><span class="cm-operator">&lt;</span><span class="cm-type">Integer</span><span class="cm-operator">&gt;</span> <span class="cm-variable">output</span> ) <span class="cm-keyword">throws</span> <span class="cm-variable">Exception</span></span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             22
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             23
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">logger</span>.<span class="cm-variable">info</span>( <span class="cm-string">"Computing sum for {}"</span>, <span class="cm-variable">input</span> );</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             24
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             25
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">int</span> <span class="cm-variable">sum</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             26
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">for</span>(<span class="cm-variable">Element</span> <span class="cm-variable">e</span> : <span class="cm-variable">input</span>) {</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             27
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">sum</span> <span class="cm-operator">+=</span> <span class="cm-variable">e</span>.<span class="cm-variable">getValue</span>();</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             28
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             29
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">output</span>.<span class="cm-variable">collect</span>( <span class="cm-variable">sum</span> );</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             30
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             31
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">})</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             32
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">.<span class="cm-variable">print</span>();</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             33
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre>
          </div>
          <div style="position: relative;">
           <div class="CodeMirror-gutter-wrapper" style="left: -31px;">
            <div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 23px;">
             34
            </div>
           </div>
           <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">env</span>.<span class="cm-variable">execute</span>();</span></pre>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 859px;">
      <br>
     </div>
     <div class="CodeMirror-gutters" style="height: 874px; left: 0px;">
      <div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 31px;">
       <br>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>
<p><br></p>
<p>Line #1 — Define a streaming execution environment to start with <a href="https://dzone.com/articles/introduction-to-streaming-etl-with-apache-flink" rel="noopener noreferrer" target="_blank">Flink</a> streaming.</p>
<p>Line #4 — Needs to be set to EventTime otherwise Flink will ignore timestamp inside elements and use the default system clock.</p>
<p>Line #6 — Create a DataStream using the ElementGenerator as source (discussed earlier in this article)</p>
<p>Line #9 — Before defining a window, I need to inform Flink how to get timestamp and watermark for each element it receives.&nbsp;</p>
<p>In this example, I am using a very handy class "<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.10/dev/event_timestamp_extractors.html#pre-defined-timestamp-extractors-watermark-emitters" rel="noopener noreferrer" target="_blank">AscendingTimestampExtractor</a>" which as per Flink doc is, <em>"A timestamp assigner and watermark generator for streams where timestamps are monotonously ascending. In this case, the local watermarks for the streams are easy to generate, because they strictly follow the timestamps."&nbsp;</em>One more benefit of using this Flink-provided API is that it will generate a watermark for me. A watermark is a way for Flink to know when to close the current Window (last element belonging to a window has arrived).</p>
<p>In short,<code>assignTimestampsAndWatermarks()</code><span id="_tmp_pre_1">will allow Flink to know how to read the timestamp from event/element coming to Flink and most important, how to compute watermarks.<br></span></p>
<p>&nbsp;Line #17<em>&nbsp;—&nbsp;</em>Define a window of type &nbsp;<code>TumblingEventTimeWindows</code><span id="_tmp_pre_1">&nbsp;with size as 10 seconds.</span></p>
<p>The rest of the code is similar to previous where we sum the values and print it.</p>
<p><strong>Sample output of the above example</strong></p>
<p><span class="fr-img-caption fr-fic fr-dib ls-is-cached lazyloaded" style="width: 808px; height: 180px;"><span class="fr-img-wrap"><img data-image="true" data-new="false" data-sizeformatted="131.7 kB" data-mimetype="image/png" data-creationdate="1582390580395" data-creationdateformatted="02/22/2020 04:56 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/13065507-1582390564872.png" data-modificationdate="null" data-size="131653" data-name="1582390564872.png" data-id="13065507" style="width: 808px; height: 180px;" data-src="https://dz2cdn1.dzone.com/storage/temp/13065507-1582390564872.png" class=" lazyloaded" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/1582390564872.png"></span></span></p>
<figcaption style="text-align:center;">
 <em>Figure 2: Output of TumblingEventWindow</em>
</figcaption>
<p>Three elements are produced at Line #1, #2, #3 with timestamp different than that of the system clock. <em>(the system clock time is printed first before log level).</em></p>
<p>When 3rd element is produced at "2020-02-22T22:22:02.495", it triggers current window closure because watermark has been breached. With a 10 seconds TimeWindow, the end time here will be "2020-02-22T22:21:59.000". So the current window collects only the first two values.</p>
<p>In the next run, the window will close at "2020-02-22T22:22:09.000" which means that value 3 and value 4 will be collected in a new window since Line #7 has an element with timestamp &gt;= current watermark.</p>
<h2>Conclusion</h2>
<p>In this article, we discussed overriding the default time clock boundary and how to work with TumblingEventTimeWindow. We also saw an example of assigning timestamp to elements.</p>
<p>In the next part, I will share and discuss handling late elements that arrive after a watermark is generated for the current window.</p>
<p><br></p>
<h2>Further Reading</h2>
<p><a href="https://dzone.com/articles/apache-flink-basic-transformation-example" rel="noopener noreferrer" target="_blank">Apache Flink Basic Transformation Example</a></p>
<p><a href="https://dzone.com/articles/getting-started-log-analysis-with-apache-flink-spr" rel="noopener noreferrer" target="_blank">Log Analysis 101 With Apache Flink, Spring Boot, and ActiveMQ</a></p></div>
                  </div>

                    <div id="bottom-bumper-container"><div id="div-gpt-ad-1435246566686-4" class="article-bumper article-bumper-bottom" data-gpt-desktop="true" data-gpt-slot="bottomBumper" data-google-query-id="CL_k87y86IsDFdzXuwgd8Moi9g"><div id="google_ads_iframe_/5055/dz2_bumper_text_ad_1__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe frameborder="0" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/container(3).html" id="google_ads_iframe_/5055/dz2_bumper_text_ad_1" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="728" height="90" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" data-google-container-id="6" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div></div>
                    <div class="article-tag-pill-container">
                        <span class="article-tag-pill">Apache Flink</span>
                        <span class="article-tag-pill">Element</span>
                        <span class="article-tag-pill">Clock (cryptography)</span>
                    </div>

                    <div class="attribution">
                      <p>Opinions expressed by DZone contributors are their own.</p>
                    </div>
                      <div class="trending-separator goto"></div>
                      <div class="trending goto">
                        <h3>Related</h3>
                        <ul>
                            <li class="item">
                              <div class="goto-link related-link" data-goto="/articles/deep-dive-into-apache-flinks-tumblingwindow-part-3">Deep Dive Into Apache Flink's TumblingWindow — Part 3</div>
                            </li>
                            <li class="item">
                              <div class="goto-link related-link" data-goto="/articles/deep-dive-into-apache-flinks-tumblingwindow">Deep Dive Into Apache Flink's TumblingWindow - Part 1</div>
                            </li>
                            <li class="item">
                              <div class="goto-link related-link" data-goto="/articles/apache-flink-full-checkpoint-vs-incremental-checkpoint">Apache Flink: Full Checkpoint vs Incremental Checkpoint</div>
                            </li>
                            <li class="item">
                              <div class="goto-link related-link" data-goto="/articles/react-callback-refs-guide">React Callback Refs: What They Are and How to Use Them</div>
                            </li>
                        </ul>
                      </div>
                </div>
              </article>
            </div>

              <div id="above-pr-ad" class="bottom-ad-container">
                <div id="div-gpt-ad-1435246566686-11" class="ads-bottom-leaderboard" data-gpt-slot="bottom" data-google-query-id="CP6_jr286IsDFQ3XuwgdCF4t_w"><div id="google_ads_iframe_/5055/dz2_article_leaderboard_3_0__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe frameborder="0" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/container(4).html" id="google_ads_iframe_/5055/dz2_article_leaderboard_3_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="728" height="90" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" data-google-container-id="7" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div>
              </div>
              <div class="layout-card widget-top-border partner-resources-block" style="width:100%; margin-bottom: 1em;">
                <div class="main-container">
                  <div class="featured-header">
                    <h2>
                      <span>Partner Resources</span>
                    </h2>
                  </div>
                  <div class="partner-resources-container">
                    <div id="div-gpt-ad-1435246566686-5" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr1" data-google-query-id="CPmHjr286IsDFUTWuwgd1OcdRA"><div id="google_ads_iframe_/5055/dz2_partner_resource_link_0__container__" style="border: 0pt none; display: inline-block; width: 100%; height: auto;"><iframe frameborder="0" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/container(5).html" id="google_ads_iframe_/5055/dz2_partner_resource_link_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="0" height="93" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" data-google-container-id="8" style="border: 0px; vertical-align: bottom; min-width: 100%;" data-load-complete="true"></iframe></div></div>
                    <div id="div-gpt-ad-1435246566686-6" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr2" data-google-query-id="CL7ej7286IsDFT_IuwgdoJUt9A"><div id="google_ads_iframe_/5055/dz2_partner_resource_link_1__container__" style="border: 0pt none; display: inline-block; width: 100%; height: auto;"><iframe frameborder="0" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/container(6).html" id="google_ads_iframe_/5055/dz2_partner_resource_link_1" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="0" height="93" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" data-google-container-id="a" style="border: 0px; vertical-align: bottom; min-width: 100%;" data-load-complete="true"></iframe></div></div>
                    <div id="div-gpt-ad-1435246566686-7" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr3" data-google-query-id="CK38jr286IsDFcnhuwgdGAol8w"><div id="google_ads_iframe_/5055/dz2_partner_resource_link_2__container__" style="border: 0pt none; display: inline-block; width: 100%; height: auto;"><iframe frameborder="0" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/container(7).html" id="google_ads_iframe_/5055/dz2_partner_resource_link_2" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="0" height="93" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" data-google-container-id="9" style="border: 0px; vertical-align: bottom; min-width: 100%;" data-load-complete="true"></iframe></div></div>
                  </div>
                </div>
              </div>
          </div>
        </div>
      </div>
    </div>

      <div id="bsa-parent" class="bottom-sticky-ad-container">
        <div id="div-gpt-ad-1635294790718-12" data-gpt-desktop="true" class="bottom-sticky-ad" data-google-query-id="CMbIzbq86IsDFc2j_QcdPL4OBQ"><div id="google_ads_iframe_/5055/sticky_footer_leaderboard_0__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe frameborder="0" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/container(8).html" id="google_ads_iframe_/5055/sticky_footer_leaderboard_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="728" height="90" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" data-google-container-id="5" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div>
      </div>

    <div class="modal fade bd-example-modal-lg" id="modal-message" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header"></div>
          <div class="modal-body"></div>
        </div>
      </div>
    </div>
  </div>
</div>
  
<div class="comments-overlay"></div>
<div id="comment-box">
  <div class="comment-box-wrapper">
    <div id="comment-input-editor"></div>
  </div>
  <div class="info hidden"></div>
  <div class="comments-content">
    <div class="comment-header">
      <hr>
      <span class="icon-comment">
        <span class="numOfComments"></span> Comments
      </span>
    </div>
    <div class="comments"></div>
  </div>
</div>

<script async="">var articleTitle = 'Deep Dive Into Apache Flink\'s TumblingWindow — Part 2';
var articleUrl = 'https://dzone.com/articles/deep-dive-into-apache-flinks-tumblingwindow-part-2';

var retweetLink = document.querySelector('#tweet-link');

function retweet(event) {
    event.preventDefault();
    event.stopPropagation();

    var twitter = 'https://twitter.com/intent/tweet';
    var params = '?text=' + encodeURIComponent(articleTitle) + '&url=' + articleUrl + '&ref=dzone.com&via=DZoneInc';
    var win = window.open(twitter + params, '_blank');
    win.focus();
}

retweetLink.addEventListener('click', retweet);

function showStatusMessage(options) {
  var modal = document.getElementById('modal-message');

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector('.modal-content .modal-body');
    var modalHeader = modal.querySelector('.modal-content .modal-header');

    modalHeader.innerText = options.header ? options.header : '';
    modalBody.innerText = options.body ? options.body : '';

    $(modal).modal('show');

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}

function showConfirmMessage(options) {
  var modal = document.getElementById('modal-message');

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector('.modal-content .modal-body');
    var modalHeader = modal.querySelector('.modal-content .modal-header');

    modalHeader.innerText = options.header ? options.header : '';
    modalBody.innerText = options.body ? options.body : '';

    if (options.textarea) {
      var textareaDiv = document.createElement('div');
      var textareaLabel = document.createElement('label');
      textareaLabel.setAttribute('for', 'modal-textarea');
      textareaLabel.innerText = options.textarea.label;

      var textarea = document.createElement('textarea');
      textarea.id = 'modal-textarea';
      textarea.placeholder = (options.textarea.placeholder || '');
      textarea.setAttribute('rows', (options.textarea.rows || 3));
      textarea.classList.add('form-control', 'not-resizable');

      if (options.textarea.maxlength) {
        textarea.maxLength = options.textarea.maxlength;
      }

      textareaDiv.appendChild(textareaLabel);
      textareaDiv.appendChild(textarea);
      modalBody.appendChild(textareaDiv);
    }

    var btnContainer = document.createElement('div');
    btnContainer.classList.add('btn-container');

    var noBtn = document.createElement('button');
    noBtn.innerText = options.noBtnText ? options.noBtnText : 'No';
    noBtn.classList.add('no-btn');

    var yesBtn = document.createElement('button');
    yesBtn.innerText = options.yesBtnText ? options.yesBtnText : 'Yes';
    yesBtn.classList.add('yes-btn');

    btnContainer.appendChild(noBtn);
    btnContainer.appendChild(yesBtn);

    modalBody.appendChild(btnContainer);

    $(modal).modal('show');

    $(noBtn).one('click', function() {
      $(modal).modal('hide');

      if(options.noCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.noCallback();
        });
      }
    });

    $(yesBtn).one('click', function() {
      $(modal).modal('hide');

      if(options.yesCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.yesCallback();
        });
      }
    });

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}

function getSuspensionBody() {
  return 'We regret to inform you that your DZone account has been suspended for violating our Guidelines. ' +
      'Please reach out to editors@dzone.com if you would like additional information.';
}</script>
<style>.engagement-overlay {
	width: 100%;
	height: 100%;
	position: fixed;
	top: 0;
	left: 0;
	background: rgb(0, 0, 0, 0.5);
	z-index: 10000;
}

.engagement-modal {
	display: flex;
	align-items: center;
	justify-content: center;
	position: fixed;
	z-index: 10;
	width: 100%;
	height: 100%;
}

.engagement-modal .inner {
	background-color: white;
	border-radius: 0.5em;
	margin: auto;
	border: 1px solid #cccccc;
}

.engagement-modal .header {
	padding: 20px 50px 10px 30px;
	position: relative;
}

.engagement-modal .title {
	font-size: 20px;
	font-weight: bold;
	color: #333333;
}

.engagement-modal .title:hover {
	text-decoration: none;
}

.engagement-modal .close {
	font-size: 18px;
	position: absolute;
	top: 18px;
	right: 20px;
	width: 32px;
	height: 32px;
	background: none;
	border: none;
	opacity: 0.8;
	font-weight: bold;
	text-shadow: 0 1px 0 #fff;
}

.engagement-modal .close:hover {
	background-color: rgba(146, 148, 151, 0.2);
	color: #000;
	border-radius: 50%;
}

.engagement-modal .close:after {
	content: '\2715';
}

.engagement-modal .content {
	padding: 0 30px 20px;
	width: min(450px, 90vw);
	height: min(450px, 90vw);
	scrollbar-width: thin;
	overflow: auto;
	overscroll-behavior: contain;
}

.engagement-modal .loading-screen,
.engagement-modal .content .center-screen {
	display: flex;
	justify-content: center;
	align-items: center;
	height: 100%;
	font-size: 18px;
}

.engagement-modal .content .center-screen a {
	color: var(--acc-ffffff-blue-1);
	font-weight: bold;
}

.engagement-modal .loading-screen i {
	font-size: 24px;
}

.engagement-modal .media-left,
.engagement-modal .media-right {
	display: table-cell;
	vertical-align: top;
}

.engagement-modal .media-left {
	padding-right: 10px;
}

.engagement-modal .media-right {
	padding-left: 10px;
}

.engagement-modal .media a {
	color: black;
	font-size: 16px;
}

.engagement-modal .avatar {
	border-radius: 50%;
}

.engagement-modal .footer {
	margin: 20px 0 0;
	display: flex;
	justify-content: center;
	align-items: center;
	background-color: unset !important;
	border-top: none !important;
}

.engagement-modal .footer .btn {
	border: 1px solid transparent;
}

.engagement-modal .footer .btn-primary {
	color: #fff;
	border-color: #2e6da4;
}

.engagement-modal .footer button {
	background-color: var(--acc-ffffff-blue-2);
	padding: 6px 12px;
	border-radius: 4px;
}

.engagement-modal .footer button:hover {
	filter: brightness(1.2);
}

@keyframes anim-spin {
	0% {
		transform: rotate(0deg);
	}
	100% {
		transform: rotate(359deg);
	}
}

.engagement-modal .anim-spin {
	display: inline-block;
	animation: anim-spin 2s infinite linear;
}</style>
<script>document.addEventListener('alpine:init', () => {
	Alpine.data('engagementModal', (nodeId) => ({

		nodeId: null,

		init() {
			this.nodeId = nodeId;
		},

		open() {
			this.updateStore();
			this.$store.article.engagement.open = true;
			if (this.$store.article.engagement.page === 1 && !this.$store.article.engagement.unauthorized) {
				this.$store.article.engagement.initializing = true;
				this.fetchEngagements();
			}
		},

		close() {
			if (this.$store.article.engagement.open) {
				this.$store.article.engagement.open = false;
			}
		},

		updateStore() {
			if (this.nodeId !== this.$store.article.id) {
				this.$store.article.engagement.reset();
				this.$store.article.id = this.nodeId;
			}
		},

		fetchEngagements() {
			if (this.$store.article.engagement.loading || !this.$store.article.engagement.additional) {
				return;
			}

			this.$store.article.engagement.loading = true;
			this.$store.global.getFromService('/services/nodes/' + this.$store.article.id + '/engagements?page=' + this.$store.article.engagement.page)
				.then(res => {
					res.json().then(data => {
						for (let user of data.engagements) {
							this.$store.article.engagement.users.push(user);
						}

						this.$store.article.engagement.additional = data.additional;
						this.$store.article.engagement.page++;
					});
				})
				.catch(err => {
					err.json().then(data => {
						if (data.error?.code === 4011) {
							this.$store.article.engagement.unauthorized = true;
						} else {
							this.$store.modal_engagement_error.open();
						}
					});
				})
				.finally(() => {
					// Allow the loader to gracefully exit
					setTimeout(() => {
						this.$store.article.engagement.loading = false;
						this.$store.article.engagement.initializing = false;
					}, 200);
				});
		},

		formatJobData(user) {
			if (user.profile.jobTitle && user.profile.companyName) {
				return user.profile.jobTitle + ', ' + user.profile.companyName;
			}

			if (user.profile.jobTitle) {
				return user.profile.jobTitle;
			}

			if (user.profile.companyName) {
				return user.profile.companyName;
			}

			return null;
		},

		isDataUnavailable() {
			return !this.$store.article.engagement.initializing && !this.$store.article.engagement.users.length;
		},

		isFooterShowing() {
			return !this.$store.article.engagement.initializing
				&& this.$store.article.engagement.additional
				&& this.$store.article.engagement.page > 1;
		}
	}));
});
</script>

    <div class="alpine-overlay" x-show="$store.modal_engagement_error._open" style="display: none;">
        <div id="modal_engagement_error" class="alpine-modal" role="dialog" tabindex="-1" x-show="$store.modal_engagement_error._open" x-on:click.self="$store.modal_engagement_error.dismissible &amp;&amp; $store.modal_engagement_error.close()" x-transition="" style="display: none;">
            <div class="dz-style modal-inner centered relative">
                <button x-show="$store.modal_engagement_error.closeable" class="btn-close" x-on:click="$store.modal_engagement_error.close()" aria-label="Close">
                </button>

                <div x-show="$store.modal_engagement_error.title" class="modal-header p-sm mt-sm mb-md">
                    <div class="title " x-text="$store.modal_engagement_error.title">Oops! Something Went Wrong</div>
                </div>

                <div class="modal-content py-md px-lg has-top-border" x-bind:class="{ &#39;has-top-border&#39;: $store.modal_engagement_error.title }">
                    <p x-show="$store.modal_engagement_error.bodyText" class="my-none" x-text="$store.modal_engagement_error.bodyText" style="display: none;"></p>
  <p>The likes didn't load as expected. Please refresh the page and try again.</p>
                </div>

                <div x-show="$store.modal_engagement_error.options.length" class="modal-footer p-sm">
                    <template x-for="option in $store.modal_engagement_error.options"></template><button x-show="option.canDisplay" x-text="option.text" type="button" x-bind:id="&#39;button_modal_engagement_error_&#39; + option.index" x-bind:class="option.classList" x-on:click="option.onClick" x-bind:disabled="option.isDisabled" id="button_modal_engagement_error_0" class="btn btn-primary hov-brighten">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("alpine:init", () => {
            Alpine.store("modal_engagement_error", {
                _open: false,
                title: "Oops! Something Went Wrong",
                bodyText: null,
                options: [{"action":"dismiss","text":"Close"}],
                closeable: true,
                dismissible: true,
                open(data) {
                    if (data) {
                        if (data.title) {
                            this.title = data.title;
                        }
                        if (data.bodyText) {
                            this.bodyText = data.bodyText;
                        }
                        if (data.options) {
                            this.options = data.options;
                        }
                        if (data.dismissAfterMs) {
                            setTimeout(() => this._open = false, data.dismissAfterMs);
                        }
                    }
                    this.updateOptions();
                    this._open = true;
                },
                close() {
                    // Manually click the buttons in which should run on dismiss.
                    // This is to keep the context. Calling this[option.action]() will not work.
                    for (let option of this.options) {
                        if (option.runOnDismiss) {
                            const element = document.querySelector('#button_modal_engagement_error_' + option.index);
                            element.click();
                        }
                    }
                    this._open = false;
                },
                updateOptions() {
                    const btnStyle = this.options.length === 2 ? ' btn-default' : '';
                    this.options = this.options.map((o, idx) => ({
                        ...o,
                        index: idx,
                        classList: o.classList ? o.classList : (idx === 0 ? "btn btn-primary hov-brighten" : "btn hov-underline" + btnStyle),
                        onClick: function() {
                            if (o.action !== "dismiss") {
                                this[o.action]();
                            }
                            this.$store["modal_engagement_error"].close();
                        },
                        isDisabled: function() {
                            return Object.hasOwn(o, 'disabled') && this[o.disabled]();
                        },
                        canDisplay: function() {
                            return !Object.hasOwn(o, 'condition') || this[o.condition]();
                        }
                    }));
                },
                init() {
                    this.updateOptions();
                }
            });
        });
    </script>

<link rel="stylesheet" media="all" href="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/styles(3).css">

<div id="ftl-footer">
  <div class="container-fluid footerOuter" style="padding-bottom: 90px;">
    <div class="row">
      <div class="col-md-12">
        <div class="container">
          <div class="row footer">
            <div class="col-md-12 footerWidget">
              <div class="row footerContainer footer">
                <div class="left col-xs-12 col-sm-7">
                  <div class="col-xs-12 social-media-icons footer-mobile">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="https://dzone.com/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank" rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="top-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ABOUT US</p>
                      <ul class="link-group">
                        <li><a href="https://dzone.com/pages/about" rel="noreferrer noopener">About DZone</a></li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">Support and feedback</a></li>
                        <li><a href="https://dzone.com/pages/dzone-community-research">Community research</a></li>
                          <li><a href="https://dzone.com/sitemap" rel="noreferrer noopener">Sitemap</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ADVERTISE</p>
                      <ul class="link-group">
                        <li><a href="https://advertise.dzone.com/" target="_blank" rel="noreferrer noopener">Advertise with DZone</a></li>
                      </ul>
                    </div>
                  </div>

                  <div class="bottom-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTRIBUTE ON DZONE</p>
                      <ul class="bottom-top-list link-group">
                        <li><a href="https://dzone.com/articles/dzones-article-submission-guidelines">Article Submission Guidelines</a></li>
                        <li><a href="https://dzone.com/pages/contribute" rel="noreferrer noopener">Become a Contributor</a></li>
                        <li><a href="https://dzone.com/pages/core" rel="noreferrer noopener">Core Program</a></li>
                        <li><a href="https://dzone.com/writers-zone" rel="noreferrer noopener">Visit the Writers' Zone</a></li>
                      </ul>

                      <p class="section-header">LEGAL</p>
                      <ul class="link-group">
                        <li><a href="https://technologyadvice.com/terms-conditions/" target="_blank" rel="noopener" referrerpolicy="no-referrer-when-downgrade">Terms of Service</a></li>
                        <li><a href="https://technologyadvice.com/privacy-policy/" target="_blank" rel="noopener" referrerpolicy="no-referrer-when-downgrade">Privacy Policy</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTACT US</p>
                      <ul class="link-group">
                        <li>3343 Perimeter Hill Drive</li>
                        <li>Suite 100</li>
                        <li>Nashville, TN 37211</li>
                        <li><a href="mailto:support@dzone.com" rel="noreferrer noopener">support@dzone.com</a></li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="right col-xs-12 col-sm-5">

                  <p class="connect-text">Let's be friends:</p>
                  <div class="col-xs-12 social-media-icons footer-wide">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="https://dzone.com/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank" rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/f(13).txt"></script>

  <script async="">
      (function(w, d, s, l, i) {
          w[l] = w[l] || [];
          w[l].push({'gtm.start': new Date().getTime(), event: 'gtm.js'});
          var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
          j.async = true;
          j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
          f.parentNode.insertBefore(j,f);
      })(window, document, 'script', 'dataLayer', 'GTM-K25QL22');
  </script>

  <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-410289-1', 'auto');
      ga('require', 'linkid', 'linkid.js');
      ga('require', 'GTM-TSD9TZP');
      ga('set', 'siteSpeedSampleRate', 25);
  </script>
  <script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/analytics.js.download"></script>
  <script async="">var analytics = {
    'dimension1': 'Java',
    'dimension2': 'article/analysis',
    'dimension3': '2020-03-27',
    'dimension4': '0',
    'dimension5': '',
    'dimension7': 'Apache Flink, element, clock',
    'dimension8': 'preetdeep.shrivastava@gmail.com',
    'dimension9': 'undefined',
    'dimension10': 'Salesforce'
};

if (window.ga) {
    Object.keys(analytics).forEach(function(key) {
        window.ga('set', key, analytics[key]);
    });

    window.ga('send', 'pageview');
}</script>

  <script>
      const articleId = 2948969;
      const likes = 7;
      const assetDomain = 'https://dz2cdn1.dzone.com';
      const codemirrorVars = {
          modeURI: 'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/mode/',
          requiredScripts: [
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.js',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/addon/mode/multiplex.js',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/mode/meta.js'
          ]
      };

      const gptTags = {
          'zone': 'Java',
          'topicTag': 'Apache Flink,element,clock',
          'company': '',
          'siteSection': 'Zones',
          'articleCategory': 'analysis',
          'nodeID': '2948969',
          'authorID': '3382657',
          'publishYear': '2020',
          'publishMonth': '03',
          'jobRole': '',
          'companySize': '',
          'env': 'prod'
      };

      const minCommentChar = 10;

        const ctaModel = null;
  </script>

  <script src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/jquery.min.js.download"></script>
  <script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/bootstrap.min.js.download"></script>
  <script async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/ads.js.download" onload="loadCTAIntoPage()"></script>

  <script>
      function loadScript(src) {
          return new Promise(function (resolve, reject) {
              const s = document.createElement('script');
              s.src = src;
              s.onload = resolve;
              s.onerror = reject;
              document.head.appendChild(s);
          });
      }

      function loadStyle(href) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = href;
          document.head.appendChild(link);
      }

      function loadScriptsSync(deferred) {
          var p = Promise.resolve();
          for (var i = 0; i < deferred.length; i++) {
              let script = deferred[i];
              p = p.then(function() {
                  return loadScript(script);
              });
          }
          return p;
      }

      function loadStyles() {
          const deferred = [
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.css',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/comments/styles.css',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/froala3/css/froala_editor.pkgd.min.css',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/froala3/css/themes/gray.min.css',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/mini-profile.css'
          ];

          for (var i = 0; i < deferred.length; i++) {
              loadStyle(deferred[i]);
          }
      }

      window.addEventListener('load', function(_event) {
          loadStyles();

          loadScriptsSync([
            'https://dz2cdn1.dzone.com/themes/dz20/lib/lazysizes.min.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/codeblocks.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/activity-bar.js',
            'https://dz2cdn1.dzone.com/themes/dz20/lib/froala3/js/froala_editor.pkgd.min.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/froala/content.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/comments/content.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/content.js'
          ]);
      });
  </script>

<iframe name="__tcfapiLocator" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/saved_resource(3).html"></iframe><div class="engagement-overlay" x-show="$store.article.engagement.open &amp;&amp; nodeId === $store.article.id" x-on:keyup.escape.window="close()" data-teleport-target="true" style="display: none;">
		<div class="engagement-modal">
			<div class="inner" x-on:click.outside="close()">
				<div class="header">
					<div class="title">Likes</div>
					<button class="close" x-on:click="close()"></button>
				</div>
				<div class="content">
					<div x-show="$store.article.engagement.initializing" class="loading-screen" style="display: none;">
						<i class="icon icon-spin3 anim-spin"></i>
					</div>
					<div x-show="!$store.article.engagement.initializing">
						<template x-for="user in $store.article.engagement.users" :key="user.id"></template>
					</div>
					<div x-show="isDataUnavailable()" class="center-screen">
						<div x-show="!$store.article.engagement.unauthorized">
							<div>There are no likes...yet! 👀</div>
							<div>Be the first to like this post!</div>
						</div>
						<div x-show="$store.article.engagement.unauthorized" style="display: none;">
							<div>It looks like you're not logged in.</div>
							<div><a href="https://dzone.com/users/login.html">Sign in</a> to see who liked this post!</div>
						</div>
					</div>
					<div x-show="isFooterShowing()" style="display: none;">
						<div class="footer">
							<button class="btn btn-primary" x-on:click="fetchEngagements()" x-bind:disabled="$store.article.engagement.loading">
								Load More
								<i x-show="$store.article.engagement.loading" class="icon icon-spin3 anim-spin" style="display: none;"></i>
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div><script id="6senseWebTag" text="" charset="" type="text/javascript" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/01192dc3-157f-4d5a-bea4-02f62692239e.js.download"></script><script type="text/javascript" id="" charset="">(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)};c=e.createElement(f);c.async=1;c.src="https://www.clarity.ms/tag/"+g;d=e.getElementsByTagName(f)[0];d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","dyr9vdlv8t");</script><script type="text/javascript" id="" charset="">window[function(d,e){for(var b="",c=0;c<d.length;c++){var a=d[c].charCodeAt();a-=e;b==b;a+=61;a!=c;9<e;a%=94;a+=33;b+=String.fromCharCode(a)}return b}(atob("YlFYendybWt8U20j"),8)]="15ea09908c1685545788";var zi=document.createElement("script");zi.type="text/javascript";zi.async=!0;zi.src=function(d,e){for(var b="",c=0;c<d.length;c++){var a=d[c].charCodeAt();a-=e;b==b;a!=c;a+=61;a%=94;a+=33;8<e;b+=String.fromCharCode(a)}return b}(atob("NUFBPUBlWlo3QFlHNlhAMD82PUFAWTA8OlpHNlhBLjRZN0A\x3d"),43);
"complete"===document.readyState?document.body.appendChild(zi):window.addEventListener("load",function(){document.body.appendChild(zi)});</script><script type="text/javascript" id="" charset="">(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)};c=e.createElement(f);c.async=1;c.src="https://www.clarity.ms/tag/"+g+"?ref\x3dgtm2";d=e.getElementsByTagName(f)[0];d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","l7xu65at89");</script><script type="text/javascript" id="" charset="">!function(b,e,f,g,a,c,d){b.saq||(a=b.saq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._saq||(b._saq=a),a.push=a,a.loaded=!0,a.version="1.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://tags.srv.stackadapt.com/events.js");saq("ts","3WSBKLflxq7D0ZW38xEGLA");</script><script type="text/javascript" id="" charset="">document.querySelectorAll('a[rel*\x3d"noreferrer"][href*\x3d"technologyadvice.com"]').forEach(function(a){var b=a.rel.split(" ");b.splice(b.indexOf("noreferrer"),1);a.rel=b.join(" ")});document.querySelectorAll('a[href*\x3d"technologyadvice.com"]').forEach(function(a){a.referrerPolicy="no-referrer-when-downgrade"});</script><script type="text/javascript" id="" charset="">(function(b,a,c){_ml=b._ml||{};_ml.eid="50027";b=a.getElementsByTagName(c)[0];var d=new Date;a=a.createElement(c);a.async=1;a.src="https://ml314.com/tag.aspx?"+d.getDate()+d.getMonth();b.parentNode.insertBefore(a,b)})(window,document,"script");</script><iframe name="googlefcPresent" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/saved_resource(4).html"></iframe><iframe name="googlefcInactive" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/saved_resource(5).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><iframe name="googlefcLoaded" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/saved_resource(6).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><script type="text/javascript" async="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/zi-tag.js.download"></script><script type="text/javascript" id="" charset="">var om56eecfe19c9dc,om56eecfe19c9dc_poll=function(){var b=0;return function(d,c){clearInterval(b);b=setInterval(d,c)}}();
!function(b,d,c){if(b.getElementById(c))om56eecfe19c9dc_poll(function(){if(window.om_loaded&&!om56eecfe19c9dc)return om56eecfe19c9dc=new OptinMonsterApp,om56eecfe19c9dc.init({s:"16961.56eecfe19c9dc",staging:0,dev:0,beta:0})},25);else{var e=!1,a=b.createElement(d);a.id=c;a.src="//a.optnmstr.com/app/js/api.min.js";a.async=!0;a.onload=a.onreadystatechange=function(){if(!(e||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState))try{e=om_loaded=!0,om56eecfe19c9dc=new OptinMonsterApp,
om56eecfe19c9dc.init({s:"16961.56eecfe19c9dc",staging:0,dev:0,beta:0}),a.onload=a.onreadystatechange=null}catch(f){}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(a)}}(document,"script","omapi-script");</script>

<script type="text/javascript" id="" charset="">document.querySelectorAll('a[rel*\x3d"noreferrer"][href*\x3d"technologyadvice.com"]').forEach(function(a){var b=a.rel.split(" ");b.splice(b.indexOf("noreferrer"),1);a.rel=b.join(" ")});document.querySelectorAll('a[href*\x3d"technologyadvice.com"]').forEach(function(a){a.referrerPolicy="no-referrer-when-downgrade"});</script><script type="text/javascript" id="" charset="">!function(){try{window.setTimeout(function(){function a(){c||(c=!0,dataLayer.push({event:"userInteraction"}),d.forEach(function(b){window.removeEventListener(b,a,{once:!0,passive:!0})}))}var d=["mouseover","keydown","touchmove","touchstart","scroll"];d.forEach(function(b){window.addEventListener(b,a,{once:!0,passive:!0})});var c=!1},1E3)}catch(a){}}();</script><iframe src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/aframe.html" width="0" height="0" style="display: none;"></iframe><div id="om-tfwmj4fdd2m34xwmnji4-holder"></div><div id="om-barftzpmq6uxmlkxqf6y-holder"></div><div id="om-tk2fvjrm26p9azmdedkm-holder"></div><script type="text/javascript" charset="utf-8" defer="" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/zischedule.js.download"></script><script type="text/javascript" charset="utf-8" async="" src="blob:https://dzone.com/824cb603-1e31-4663-96d4-e4c3d4634262"></script><iframe id="universal_pixel_5fjyxkv" height="0" width="0" style="display:none;" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/up.html" title="TTD Universal Pixel"></iframe><script type="text/javascript" id="" charset="">targetBottomStickyAd();</script></body><iframe name="goog_topics_frame" src="./Deep Dive Into Apache Flink&#39;s TumblingWindow — Part 2_files/topics_frame.html" style="display: none;"></iframe></html>